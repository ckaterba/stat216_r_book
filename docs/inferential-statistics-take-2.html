<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Inferential statistics, take 2 | R and RStudio for STAT216</title>
  <meta name="description" content="<p>These notes introduce the reader to R and RStudio following the rough structure
of STAT216 at FVCC.</p>" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Inferential statistics, take 2 | R and RStudio for STAT216" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>These notes introduce the reader to R and RStudio following the rough structure
of STAT216 at FVCC.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Inferential statistics, take 2 | R and RStudio for STAT216" />
  
  <meta name="twitter:description" content="<p>These notes introduce the reader to R and RStudio following the rough structure
of STAT216 at FVCC.</p>" />
  

<meta name="author" content="Charles Katerba" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="inferential-statistics-take-1.html"/>
<link rel="next" href="modeling-relationships.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for STAT216 @ FVCC</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#organization"><i class="fa fa-check"></i><b>1.1</b> Organization</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#getting-started"><i class="fa fa-check"></i><b>1.2</b> Getting started</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#code-in-this-book"><i class="fa fa-check"></i><b>1.3</b> Code in this book</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#help"><i class="fa fa-check"></i><b>1.4</b> Help</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#debugging"><i class="fa fa-check"></i><b>1.5</b> Debugging</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#other-resources"><i class="fa fa-check"></i><b>1.6</b> Other resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rstudio-basics.html"><a href="rstudio-basics.html"><i class="fa fa-check"></i><b>2</b> RStudio basics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rstudio-basics.html"><a href="rstudio-basics.html#a-big-calculator"><i class="fa fa-check"></i><b>2.1</b> A big calculator</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="rstudio-basics.html"><a href="rstudio-basics.html#numbers"><i class="fa fa-check"></i><b>2.1.1</b> Numbers</a></li>
<li class="chapter" data-level="2.1.2" data-path="rstudio-basics.html"><a href="rstudio-basics.html#strings"><i class="fa fa-check"></i><b>2.1.2</b> Strings</a></li>
<li class="chapter" data-level="2.1.3" data-path="rstudio-basics.html"><a href="rstudio-basics.html#logicals-and-logical-operators"><i class="fa fa-check"></i><b>2.1.3</b> Logicals and Logical operators</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="rstudio-basics.html"><a href="rstudio-basics.html#naming-things"><i class="fa fa-check"></i><b>2.2</b> Naming things</a></li>
<li class="chapter" data-level="2.3" data-path="rstudio-basics.html"><a href="rstudio-basics.html#lists-and-vectors"><i class="fa fa-check"></i><b>2.3</b> Lists and vectors</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="rstudio-basics.html"><a href="rstudio-basics.html#creating-lists"><i class="fa fa-check"></i><b>2.3.1</b> Creating lists</a></li>
<li class="chapter" data-level="2.3.2" data-path="rstudio-basics.html"><a href="rstudio-basics.html#subsetting-lists"><i class="fa fa-check"></i><b>2.3.2</b> Subsetting lists</a></li>
<li class="chapter" data-level="2.3.3" data-path="rstudio-basics.html"><a href="rstudio-basics.html#special-lists"><i class="fa fa-check"></i><b>2.3.3</b> Special lists</a></li>
<li class="chapter" data-level="2.3.4" data-path="rstudio-basics.html"><a href="rstudio-basics.html#list-arithmetic"><i class="fa fa-check"></i><b>2.3.4</b> List arithmetic</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="rstudio-basics.html"><a href="rstudio-basics.html#packages"><i class="fa fa-check"></i><b>2.4</b> Packages</a></li>
<li class="chapter" data-level="2.5" data-path="rstudio-basics.html"><a href="rstudio-basics.html#data-frames-and-tibbles"><i class="fa fa-check"></i><b>2.5</b> Data frames and tibbles</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="rstudio-basics.html"><a href="rstudio-basics.html#creating-data-frames"><i class="fa fa-check"></i><b>2.5.1</b> Creating data frames</a></li>
<li class="chapter" data-level="2.5.2" data-path="rstudio-basics.html"><a href="rstudio-basics.html#using-data-frames"><i class="fa fa-check"></i><b>2.5.2</b> Using data frames</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="rstudio-basics.html"><a href="rstudio-basics.html#r-markdown-documents"><i class="fa fa-check"></i><b>2.6</b> R Markdown documents</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cross.html"><a href="cross.html"><i class="fa fa-check"></i><b>3</b> Summary statistics and data visualization</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cross.html"><a href="cross.html#summary-statistics-in-r"><i class="fa fa-check"></i><b>3.1</b> Summary statistics in R</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="cross.html"><a href="cross.html#numerical-variables"><i class="fa fa-check"></i><b>3.1.1</b> Numerical variables</a></li>
<li class="chapter" data-level="3.1.2" data-path="cross.html"><a href="cross.html#categorical-variables"><i class="fa fa-check"></i><b>3.1.2</b> Categorical variables</a></li>
<li class="chapter" data-level="3.1.3" data-path="cross.html"><a href="cross.html#combining-it-all"><i class="fa fa-check"></i><b>3.1.3</b> Combining it all</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="cross.html"><a href="cross.html#data-visualization"><i class="fa fa-check"></i><b>3.2</b> Data visualization</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="cross.html"><a href="cross.html#base-r"><i class="fa fa-check"></i><b>3.2.1</b> Base R</a></li>
<li class="chapter" data-level="3.2.2" data-path="cross.html"><a href="cross.html#ggplot2"><i class="fa fa-check"></i><b>3.2.2</b> <code>ggplot2</code></a></li>
<li class="chapter" data-level="3.2.3" data-path="cross.html"><a href="cross.html#saving-plots"><i class="fa fa-check"></i><b>3.2.3</b> Saving plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="wrangling-data.html"><a href="wrangling-data.html"><i class="fa fa-check"></i><b>4</b> Wrangling data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="wrangling-data.html"><a href="wrangling-data.html#the-goal-tidy-data."><i class="fa fa-check"></i><b>4.1</b> The goal: “tidy” data.</a></li>
<li class="chapter" data-level="4.2" data-path="wrangling-data.html"><a href="wrangling-data.html#the-pipe"><i class="fa fa-check"></i><b>4.2</b> The pipe</a></li>
<li class="chapter" data-level="4.3" data-path="wrangling-data.html"><a href="wrangling-data.html#common-tidying-operations"><i class="fa fa-check"></i><b>4.3</b> Common tidying operations</a></li>
<li class="chapter" data-level="4.4" data-path="wrangling-data.html"><a href="wrangling-data.html#mutate-group-by-and-summarize"><i class="fa fa-check"></i><b>4.4</b> Mutate, group by, and summarize</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="distribution-calculations.html"><a href="distribution-calculations.html"><i class="fa fa-check"></i><b>5</b> Distribution calculations</a>
<ul>
<li class="chapter" data-level="5.1" data-path="distribution-calculations.html"><a href="distribution-calculations.html#finite-discrete-distribution-calculations"><i class="fa fa-check"></i><b>5.1</b> Finite discrete distribution calculations</a></li>
<li class="chapter" data-level="5.2" data-path="distribution-calculations.html"><a href="distribution-calculations.html#named-distribution-calculations"><i class="fa fa-check"></i><b>5.2</b> Named distribution calculations</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="distribution-calculations.html"><a href="distribution-calculations.html#discrete-random-variables"><i class="fa fa-check"></i><b>5.2.1</b> Discrete random variables</a></li>
<li class="chapter" data-level="5.2.2" data-path="distribution-calculations.html"><a href="distribution-calculations.html#continuous-random-variables"><i class="fa fa-check"></i><b>5.2.2</b> Continuous random variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html"><i class="fa fa-check"></i><b>6</b> Inferential statistics: Take 1</a>
<ul>
<li class="chapter" data-level="6.1" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#basics-of-statistical-inference"><i class="fa fa-check"></i><b>6.1</b> Basics of statistical inference</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#sampling-distributions"><i class="fa fa-check"></i><b>6.1.1</b> Sampling distributions</a></li>
<li class="chapter" data-level="6.1.2" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#confidence-intervals"><i class="fa fa-check"></i><b>6.1.2</b> Confidence intervals</a></li>
<li class="chapter" data-level="6.1.3" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#hypothesis-tests"><i class="fa fa-check"></i><b>6.1.3</b> Hypothesis tests</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#analyzing-categorical-variables"><i class="fa fa-check"></i><b>6.2</b> Analyzing categorical variables</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#single-sample-proportion"><i class="fa fa-check"></i><b>6.2.1</b> Single sample proportion</a></li>
<li class="chapter" data-level="6.2.2" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#two-sample-proportion"><i class="fa fa-check"></i><b>6.2.2</b> Two sample proportion</a></li>
<li class="chapter" data-level="6.2.3" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#chi-squared-tests"><i class="fa fa-check"></i><b>6.2.3</b> Chi-squared tests</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#analyzing-numerical-variables"><i class="fa fa-check"></i><b>6.3</b> Analyzing numerical variables</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#single-sample-mean"><i class="fa fa-check"></i><b>6.3.1</b> Single sample mean</a></li>
<li class="chapter" data-level="6.3.2" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#two-sample-mean"><i class="fa fa-check"></i><b>6.3.2</b> Two sample mean</a></li>
<li class="chapter" data-level="6.3.3" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#paired-data"><i class="fa fa-check"></i><b>6.3.3</b> Paired data</a></li>
<li class="chapter" data-level="6.3.4" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#analysis-of-variance-anova"><i class="fa fa-check"></i><b>6.3.4</b> Analysis of variance (ANOVA)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html"><i class="fa fa-check"></i><b>7</b> Inferential statistics, take 2</a>
<ul>
<li class="chapter" data-level="7.1" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#analyzing-categorical-variables-1"><i class="fa fa-check"></i><b>7.1</b> Analyzing categorical variables</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#single-sample-proportions"><i class="fa fa-check"></i><b>7.1.1</b> Single sample proportions</a></li>
<li class="chapter" data-level="7.1.2" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#two-sample-proportions"><i class="fa fa-check"></i><b>7.1.2</b> Two sample proportions</a></li>
<li class="chapter" data-level="7.1.3" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#chi-squared-goodness-of-fit-test"><i class="fa fa-check"></i><b>7.1.3</b> Chi-squared goodness of fit test</a></li>
<li class="chapter" data-level="7.1.4" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#chi-squared-test-of-independence-1"><i class="fa fa-check"></i><b>7.1.4</b> Chi-squared test of independence</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#analyzing-numerical-variables-1"><i class="fa fa-check"></i><b>7.2</b> Analyzing numerical variables</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#single-sample-mean-1"><i class="fa fa-check"></i><b>7.2.1</b> Single sample mean</a></li>
<li class="chapter" data-level="7.2.2" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#two-sample-mean-1"><i class="fa fa-check"></i><b>7.2.2</b> Two sample mean</a></li>
<li class="chapter" data-level="7.2.3" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#paired-data-1"><i class="fa fa-check"></i><b>7.2.3</b> Paired data</a></li>
<li class="chapter" data-level="7.2.4" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#analysis-of-variance-anova-1"><i class="fa fa-check"></i><b>7.2.4</b> Analysis of variance (ANOVA)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modeling-relationships.html"><a href="modeling-relationships.html"><i class="fa fa-check"></i><b>8</b> Modeling relationships</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modeling-relationships.html"><a href="modeling-relationships.html#simple-linear-regression"><i class="fa fa-check"></i><b>8.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="8.2" data-path="modeling-relationships.html"><a href="modeling-relationships.html#multiple-linear-regression"><i class="fa fa-check"></i><b>8.2</b> Multiple linear regression</a></li>
<li class="chapter" data-level="8.3" data-path="modeling-relationships.html"><a href="modeling-relationships.html#bonus-topic-logistic-regression"><i class="fa fa-check"></i><b>8.3</b> Bonus topic: logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R and RStudio for STAT216</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inferential-statistics-take-2" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Inferential statistics, take 2<a href="inferential-statistics-take-2.html#inferential-statistics-take-2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter will show you how to calculate confidence intervals and perform hypothesis tests using R’s in-built hypothesis testing functions. We will quickly go over the same examples from the previous sections using R’s functions to recover the values we calculated earlier.</p>
<div id="analyzing-categorical-variables-1" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Analyzing categorical variables<a href="inferential-statistics-take-2.html#analyzing-categorical-variables-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will learn how to use two workhorse functions in this section: <code>prop.test(...)</code> and <code>chisq.test(...)</code>. The former will be used for making inferences for single and two sample proportions, while the latter will be used for chi squared goodness of fit tests and tests of independence.</p>
<p><strong>Remember</strong> You can always run <code>?prop.test</code> or <code>?chisq.test</code> in the console to view <code>R</code>’s help documentation for these functions.</p>
<div id="single-sample-proportions" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Single sample proportions<a href="inferential-statistics-take-2.html#single-sample-proportions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The main function we will use in this section is <code>prop.test(...)</code>; it both calculates confidence intervals <em>and</em> performs hypothesis tests all in one fell swoop! The important things for us, then, are understanding what inputs we need and understanding the outputs. For single-sample proportion inferences, the function <code>prop.test</code> requires the following inputs:</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="inferential-statistics-take-2.html#cb562-1" tabindex="-1"></a><span class="fu">prop.test</span>(</span>
<span id="cb562-2"><a href="inferential-statistics-take-2.html#cb562-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="co"># The number of successes</span></span>
<span id="cb562-3"><a href="inferential-statistics-take-2.html#cb562-3" tabindex="-1"></a>  , <span class="at">n =</span> <span class="co"># the sample size</span></span>
<span id="cb562-4"><a href="inferential-statistics-take-2.html#cb562-4" tabindex="-1"></a>  , <span class="at">p =</span> <span class="co"># the null proportion of your hypothesis test, the devault value is NULL</span></span>
<span id="cb562-5"><a href="inferential-statistics-take-2.html#cb562-5" tabindex="-1"></a>  , <span class="at">alternative =</span> <span class="co"># the type of hypothesis test to run corresponding to your alternative hypothesis; one of &quot;two.sided&quot;, &quot;less&quot;, or &quot;greater&quot;</span></span>
<span id="cb562-6"><a href="inferential-statistics-take-2.html#cb562-6" tabindex="-1"></a>  , <span class="at">conf.level =</span> <span class="co"># your confidence level as a decimal</span></span>
<span id="cb562-7"><a href="inferential-statistics-take-2.html#cb562-7" tabindex="-1"></a>  , <span class="at">correct =</span> <span class="cn">FALSE</span> <span class="co"># This turns OFF the Yates&#39; continuity correction so that calculations are made like we&#39;ve learned in class.</span></span>
<span id="cb562-8"><a href="inferential-statistics-take-2.html#cb562-8" tabindex="-1"></a>)</span></code></pre></div>
<p>The function will output the results of our desired hypothesis test and a corresponding confidence interval.</p>
<p><strong>Note:</strong> The confidence interval intervals that <code>R</code> calculates are ever-so-slightly different from those that we calculate by hand in two important ways:</p>
<ul>
<li><p>Setting the option <code>correct = FALSE</code> gets us closer to our by-hand techniques, but <code>R</code> still uses a slightly different method under the hood. See <a href="https://stats.stackexchange.com/questions/183225/confidence-interval-from-rs-prop-test-differs-from-hand-calculation-and-resul">this CrossValidated Stack Exchange post</a> for more information.</p></li>
<li><p>If your alternative hypothesis is one-sided and you select the option <code>alternative = "less"</code> or <code>alternative = "greater"</code>, then <code>R</code> will report a one-sided confidence interval that we do not discuss in this class.</p></li>
</ul>
<p>To understand the output of <code>prop.test(...)</code> and witness the discrepancies mentioned above, let’s return to the 3 basic examples we started with in the previous chapter. Recall that we have a hypothetical example with</p>
<ul>
<li><p><span class="math inline">\(n = 200\)</span></p></li>
<li><p>Our sample has 110 successes, ie <span class="math inline">\(\hat{p} = .55\)</span></p></li>
<li><p>we are comparing our sample data to the null hypothesis <span class="math inline">\(H_0: p = .5\)</span></p></li>
</ul>
<ol style="list-style-type: decimal">
<li><strong>Two-sided hypothesis test:</strong> In this case our hypothesis test is</li>
</ol>
<p><span class="math display">\[\begin{array}{cc}
H_0: p = .5 \\
H_a: p \neq .5
\end{array}
    \]</span></p>
<p>It is quite easy to perform this hypothesis test with the function <code>prop.test(...)</code>, we simply run the following code.</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="inferential-statistics-take-2.html#cb563-1" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(</span>
<span id="cb563-2"><a href="inferential-statistics-take-2.html#cb563-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">110</span> <span class="co"># the NUMBER of successes</span></span>
<span id="cb563-3"><a href="inferential-statistics-take-2.html#cb563-3" tabindex="-1"></a>  , <span class="at">n =</span> <span class="dv">200</span> <span class="co"># sample size</span></span>
<span id="cb563-4"><a href="inferential-statistics-take-2.html#cb563-4" tabindex="-1"></a>  , <span class="at">p =</span> .<span class="dv">5</span> <span class="co"># the null proportion</span></span>
<span id="cb563-5"><a href="inferential-statistics-take-2.html#cb563-5" tabindex="-1"></a>  , <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span> <span class="co"># since we&#39;re doing a two-sided hypothesis test</span></span>
<span id="cb563-6"><a href="inferential-statistics-take-2.html#cb563-6" tabindex="-1"></a>  , <span class="at">conf.level =</span> .<span class="dv">95</span></span>
<span id="cb563-7"><a href="inferential-statistics-take-2.html#cb563-7" tabindex="-1"></a>  , <span class="at">correct =</span> <span class="cn">FALSE</span></span>
<span id="cb563-8"><a href="inferential-statistics-take-2.html#cb563-8" tabindex="-1"></a>)</span>
<span id="cb563-9"><a href="inferential-statistics-take-2.html#cb563-9" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## 
##  1-sample proportions test without continuity correction
## 
## data:  110 out of 200, null probability 0.5
## X-squared = 2, df = 1, p-value = 0.1573
## alternative hypothesis: true p is not equal to 0.5
## 95 percent confidence interval:
##  0.4807562 0.6173593
## sample estimates:
##    p 
## 0.55</code></pre>
<p>Notice that the code stores the output of the hypothesis test as the variable <code>result</code>, then prints a summary of the test. Take a few moments to read through the results and notice that it gives us all of the information we want! In particular,</p>
<ul>
<li><p>the “sample estimate” <code>p</code> is the sample proportion <span class="math inline">\(\hat{p}\)</span>;</p></li>
<li><p>the <span class="math inline">\(p\)</span>-value is about 0.1573;</p></li>
<li><p>the associated 95% confidence interval is <span class="math inline">\((0.4807, 0.6173)\)</span>;</p></li>
</ul>
<p>Let’s compare this with the results we’d obtain making the same calculations “by hand. First we’ll calculate a <span class="math inline">\(p\)</span>-value and compare it to that calculated by <code>prop.test</code> above.</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="inferential-statistics-take-2.html#cb565-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb565-2"><a href="inferential-statistics-take-2.html#cb565-2" tabindex="-1"></a>pHat <span class="ot">&lt;-</span> <span class="dv">110</span><span class="sc">/</span><span class="dv">200</span></span>
<span id="cb565-3"><a href="inferential-statistics-take-2.html#cb565-3" tabindex="-1"></a>null.SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(.<span class="dv">5</span><span class="sc">*</span>.<span class="dv">5</span><span class="sc">/</span><span class="dv">200</span>)</span>
<span id="cb565-4"><a href="inferential-statistics-take-2.html#cb565-4" tabindex="-1"></a>p.value.hand <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pnorm</span>(pHat, <span class="at">mean =</span> .<span class="dv">5</span>, <span class="at">sd =</span> null.SE, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb565-5"><a href="inferential-statistics-take-2.html#cb565-5" tabindex="-1"></a></span>
<span id="cb565-6"><a href="inferential-statistics-take-2.html#cb565-6" tabindex="-1"></a><span class="fu">c</span>(p.value.hand, result<span class="sc">$</span>p.value)</span></code></pre></div>
<pre><code>## [1] 0.1572992 0.1572992</code></pre>
<p>They’re the same, just as we would hope. Now let’s calculate a 95% confidence interval “by hand” and compare the results to that calculated by <code>prop.test</code> above.</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="inferential-statistics-take-2.html#cb567-1" tabindex="-1"></a>conf.int.hand <span class="ot">&lt;-</span> pHat <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">*</span><span class="fl">1.96</span><span class="sc">*</span>null.SE</span>
<span id="cb567-2"><a href="inferential-statistics-take-2.html#cb567-2" tabindex="-1"></a><span class="co"># our result</span></span>
<span id="cb567-3"><a href="inferential-statistics-take-2.html#cb567-3" tabindex="-1"></a>conf.int.hand</span></code></pre></div>
<pre><code>## [1] 0.4807035 0.6192965</code></pre>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="inferential-statistics-take-2.html#cb569-1" tabindex="-1"></a><span class="co">#from prop.test</span></span>
<span id="cb569-2"><a href="inferential-statistics-take-2.html#cb569-2" tabindex="-1"></a>result<span class="sc">$</span>conf.in</span></code></pre></div>
<pre><code>## [1] 0.4807562 0.6173593
## attr(,&quot;conf.level&quot;)
## [1] 0.95</code></pre>
<p>Notice that the bounds of our “by hand” calculation are ever so slightly different from the bounds calculated by <code>prop.test</code> - this is because R calculates these confidence intervals with slightly different and more sophisticated techniques than we cover in this class. Fret not, however, as the outputs in most cases are similar enough. One interesting thing to observer is that the confidence interval from <code>prop.test</code> is <em>not</em> symmetric about the sample proportion <span class="math inline">\(\hat{p}\)</span>!</p>
<p>In our remaining examples, we will move a little more quickly.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>One-sided lower hypothesis test:</strong> In this case our hypothesis test is</li>
</ol>
<p><span class="math display">\[\begin{array}{cc}
H_0: p = .5 \\
H_a: p &lt; .5
\end{array}
    \]</span></p>
<p>This hypothesis test is quite easy to evaluate as well will <code>prop.test</code>. See the code below:</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="inferential-statistics-take-2.html#cb571-1" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(</span>
<span id="cb571-2"><a href="inferential-statistics-take-2.html#cb571-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">110</span> <span class="co"># the NUMBER of successes</span></span>
<span id="cb571-3"><a href="inferential-statistics-take-2.html#cb571-3" tabindex="-1"></a>  , <span class="at">n =</span> <span class="dv">200</span> <span class="co"># sample size</span></span>
<span id="cb571-4"><a href="inferential-statistics-take-2.html#cb571-4" tabindex="-1"></a>  , <span class="at">p =</span> .<span class="dv">5</span> <span class="co"># the null proportion</span></span>
<span id="cb571-5"><a href="inferential-statistics-take-2.html#cb571-5" tabindex="-1"></a>  , <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span> <span class="co"># ONLY CHANGE FROM Above</span></span>
<span id="cb571-6"><a href="inferential-statistics-take-2.html#cb571-6" tabindex="-1"></a>  , <span class="at">conf.level =</span> .<span class="dv">95</span></span>
<span id="cb571-7"><a href="inferential-statistics-take-2.html#cb571-7" tabindex="-1"></a>  , <span class="at">correct =</span> <span class="cn">FALSE</span></span>
<span id="cb571-8"><a href="inferential-statistics-take-2.html#cb571-8" tabindex="-1"></a>)</span>
<span id="cb571-9"><a href="inferential-statistics-take-2.html#cb571-9" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## 
##  1-sample proportions test without continuity correction
## 
## data:  110 out of 200, null probability 0.5
## X-squared = 2, df = 1, p-value = 0.9214
## alternative hypothesis: true p is less than 0.5
## 95 percent confidence interval:
##  0.0000000 0.6068119
## sample estimates:
##    p 
## 0.55</code></pre>
<p>Most of the output is exactly as we’d expect it to be. The <span class="math inline">\(p\)</span>-value of this test is the complement of half of the <span class="math inline">\(p\)</span>-value from the two-sided test (think about the corresponding tail areas shaded under a normal distribution) and the point estimate is the same.</p>
<p><strong>Caution:</strong> The main change is the output of the confidence interval. Because this is a one-sided tests, R reports a one-sided confidence interval that we do not cover in this class. Suppose <span class="math inline">\(\alpha\)</span> is the significance level as decimal with corresponding <span class="math inline">\(z\)</span>-critical value <span class="math inline">\(z_\alpha\)</span>. Then a one-sided lower confidence interval is approximately</p>
<p><span class="math display">\[ \left( 0, \hat{p} + z_\alpha * SE\right) \]</span></p>
<p>For our example, we can calculate this by hand for a 95% confidence interval, the corresponding significance level is .05, so <span class="math inline">\(\alpha = .05\)</span>.</p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="inferential-statistics-take-2.html#cb573-1" tabindex="-1"></a>z.crit <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(.<span class="dv">05</span>, <span class="at">lower.tail =</span> F)</span>
<span id="cb573-2"><a href="inferential-statistics-take-2.html#cb573-2" tabindex="-1"></a>pHat <span class="sc">+</span> z.crit<span class="sc">*</span>null.SE</span></code></pre></div>
<pre><code>## [1] 0.6081544</code></pre>
<p>This is very close to, but not exactly, the upper bound of the confidence interval given by R’s <code>prop.test</code> function. For our purposes they are close enough. That said, if you are looking for a confidence interval as we calculate them in class, set the <code>alternative</code> option to <code>"two.sided"</code>.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>One-sided upper hypothesis test:</strong> In this case our hypothesis test is</li>
</ol>
<p><span class="math display">\[\begin{array}{cc}
H_0: p = .5 \\
H_a: p &gt; .5
\end{array}
    \]</span></p>
<p>This hypothesis test is quite easy to evaluate as well will <code>prop.test</code>. See the code below:</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="inferential-statistics-take-2.html#cb575-1" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(</span>
<span id="cb575-2"><a href="inferential-statistics-take-2.html#cb575-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">110</span> <span class="co"># the NUMBER of successes</span></span>
<span id="cb575-3"><a href="inferential-statistics-take-2.html#cb575-3" tabindex="-1"></a>  , <span class="at">n =</span> <span class="dv">200</span> <span class="co"># sample size</span></span>
<span id="cb575-4"><a href="inferential-statistics-take-2.html#cb575-4" tabindex="-1"></a>  , <span class="at">p =</span> .<span class="dv">5</span> <span class="co"># the null proportion</span></span>
<span id="cb575-5"><a href="inferential-statistics-take-2.html#cb575-5" tabindex="-1"></a>  , <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span> <span class="co"># ONLY CHANGE FROM Above</span></span>
<span id="cb575-6"><a href="inferential-statistics-take-2.html#cb575-6" tabindex="-1"></a>  , <span class="at">conf.level =</span> .<span class="dv">95</span></span>
<span id="cb575-7"><a href="inferential-statistics-take-2.html#cb575-7" tabindex="-1"></a>  , <span class="at">correct =</span> <span class="cn">FALSE</span></span>
<span id="cb575-8"><a href="inferential-statistics-take-2.html#cb575-8" tabindex="-1"></a>)</span>
<span id="cb575-9"><a href="inferential-statistics-take-2.html#cb575-9" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## 
##  1-sample proportions test without continuity correction
## 
## data:  110 out of 200, null probability 0.5
## X-squared = 2, df = 1, p-value = 0.07865
## alternative hypothesis: true p is greater than 0.5
## 95 percent confidence interval:
##  0.4918534 1.0000000
## sample estimates:
##    p 
## 0.55</code></pre>
<p>The result of this test is very similar to the output from the one-sided lower example and all of the same comments apply. Again, the main change is the reported confidence interval.</p>
<p><strong>Caution:</strong> As in the case of a one-sided lower test, R reports a one-sided confidence interval, which deviates from what we learn in this class! Suppose <span class="math inline">\(\alpha\)</span> is the significance level as decimal with corresponding <span class="math inline">\(z\)</span>-critical value <span class="math inline">\(z_\alpha\)</span>. Then a one-sided lower confidence interval is approximately</p>
<p><span class="math display">\[ \left( \hat{p} - z_\alpha * SE, 1 \right)  \]</span></p>
<p>For our example, we can calculate this by hand for a 95% confidence interval, the corresponding significance level is .05, so <span class="math inline">\(\alpha = .05\)</span>. The lower-bound for the one-sided confidence interval is</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="inferential-statistics-take-2.html#cb577-1" tabindex="-1"></a>z.crit <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(.<span class="dv">05</span>, <span class="at">lower.tail =</span> F)</span>
<span id="cb577-2"><a href="inferential-statistics-take-2.html#cb577-2" tabindex="-1"></a>pHat <span class="sc">-</span> z.crit<span class="sc">*</span>null.SE</span></code></pre></div>
<pre><code>## [1] 0.4918456</code></pre>
<p>This is very close to, but not exactly, the lower bound of the confidence interval given by R’s <code>prop.test</code> function.</p>
<p>As a reminder, if you are looking for a confidence interval as we calculate them in class, set the <code>alternative</code> option to <code>"two.sided"</code>.</p>
<div id="real-life-single-sample-proportion-test." class="section level4 hasAnchor" number="7.1.1.1">
<h4><span class="header-section-number">7.1.1.1</span> “Real Life” Single sample proportion test.<a href="inferential-statistics-take-2.html#real-life-single-sample-proportion-test." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We close this section with an example of a single sample proportion test where we start with real-world data. As in the previous chapter we’ll use the <code>gss2010</code> data set from the <code>openintro</code> package. Here are the first six rows of this data set.</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="inferential-statistics-take-2.html#cb579-1" tabindex="-1"></a><span class="fu">head</span>(gss2010)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##   hrsrelax mntlhlth  hrs1 degree         grass    
##      &lt;int&gt;    &lt;int&gt; &lt;int&gt; &lt;fct&gt;          &lt;fct&gt;    
## 1        2        3    55 BACHELOR       &lt;NA&gt;     
## 2        4        6    45 BACHELOR       LEGAL    
## 3       NA       NA    NA LT HIGH SCHOOL &lt;NA&gt;     
## 4       NA       NA    NA LT HIGH SCHOOL NOT LEGAL
## 5       NA       NA    NA LT HIGH SCHOOL NOT LEGAL
## 6       NA       NA    NA LT HIGH SCHOOL LEGAL</code></pre>
<p>As of writing, we note that marijuana is legal in many states, so we will assume that a majority of American’s in 2024 believe that the drug should be legalized. We want to use the <code>gss2010</code> data to try to see if the national opinion has changed over the past 14 years. In other words, did a minority of Americans think marijuana should be legalized in 2010?</p>
<p>If <span class="math inline">\(p\)</span> denotes the proportion of Americans who think marijuana should be legalized, the hypothesis test we should use to answer this question is</p>
<p><span class="math display">\[\begin{array}{cc}
H_0: p = .5 \quad (\text{or} \quad p \geq .5) \\
H_a: p &lt; .5
\end{array}
    \]</span></p>
<p>We should look at the <code>grass</code> column of the data set which records respondents’ answers to the question “Do you think the use of marijuana should be made legal, or not?” Some of the entries in this column are <code>NA</code>, so we should drop these values from our data set. <strong>Note:</strong> before dropping these values, it might be good to check to see if there’s a correlation between the respondents who did not reply and their educational level because degree is the only complete column in this data set and we need to be careful about maintaining independence among observations. One could check this with a chi-squared test of independence, but we will eyeball it for now.</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="inferential-statistics-take-2.html#cb581-1" tabindex="-1"></a>gss2010 <span class="sc">%&gt;%</span></span>
<span id="cb581-2"><a href="inferential-statistics-take-2.html#cb581-2" tabindex="-1"></a>  <span class="co"># add a binary column for replying to the grass question</span></span>
<span id="cb581-3"><a href="inferential-statistics-take-2.html#cb581-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grassReply =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(grass),  <span class="st">&#39;No&#39;</span>, <span class="st">&#39;Yes&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb581-4"><a href="inferential-statistics-take-2.html#cb581-4" tabindex="-1"></a>  <span class="co"># create a two-way table for degree and grassReply</span></span>
<span id="cb581-5"><a href="inferential-statistics-take-2.html#cb581-5" tabindex="-1"></a>  <span class="fu">xtabs</span>(<span class="sc">~</span>degree <span class="sc">+</span> grassReply, <span class="at">data =</span> .) <span class="sc">%&gt;%</span></span>
<span id="cb581-6"><a href="inferential-statistics-take-2.html#cb581-6" tabindex="-1"></a>  <span class="co"># create a proportion table where we divide by the column totals</span></span>
<span id="cb581-7"><a href="inferential-statistics-take-2.html#cb581-7" tabindex="-1"></a>  <span class="fu">prop.table</span>(., <span class="at">margin =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##                 grassReply
## degree                   No        Yes
##   BACHELOR       0.18343949 0.18347895
##   GRADUATE       0.10445860 0.10802224
##   HIGH SCHOOL    0.49681529 0.48530580
##   JUNIOR COLLEGE 0.07515924 0.06830818
##   LT HIGH SCHOOL 0.14012739 0.15488483</code></pre>
<p>The proportion table above shows that the distribution of educational attainment is just about the same between those that did and did not reply to the question about marijuana legalization. Thus, we can safely drop the <code>NA</code> values from the grass column and proceed with our hypothesis test. To use <code>prop.test</code> we need the sample size and the number of people who responded <code>LEGAL</code> to the grass question.</p>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb583-1"><a href="inferential-statistics-take-2.html#cb583-1" tabindex="-1"></a>gss2010 <span class="sc">%&gt;%</span> </span>
<span id="cb583-2"><a href="inferential-statistics-take-2.html#cb583-2" tabindex="-1"></a>  <span class="co">#select all rows where grass is not NA</span></span>
<span id="cb583-3"><a href="inferential-statistics-take-2.html#cb583-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(grass)) <span class="sc">%&gt;%</span></span>
<span id="cb583-4"><a href="inferential-statistics-take-2.html#cb583-4" tabindex="-1"></a>  <span class="co"># get sample size and number of respondents answering legal and not legal</span></span>
<span id="cb583-5"><a href="inferential-statistics-take-2.html#cb583-5" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb583-6"><a href="inferential-statistics-take-2.html#cb583-6" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb583-7"><a href="inferential-statistics-take-2.html#cb583-7" tabindex="-1"></a>    , <span class="at">notLegal =</span> <span class="fu">sum</span>(grass <span class="sc">==</span> <span class="st">&#39;NOT LEGAL&#39;</span>)</span>
<span id="cb583-8"><a href="inferential-statistics-take-2.html#cb583-8" tabindex="-1"></a>    , <span class="at">legal =</span> <span class="fu">sum</span>(grass <span class="sc">==</span> <span class="st">&#39;LEGAL&#39;</span>)</span>
<span id="cb583-9"><a href="inferential-statistics-take-2.html#cb583-9" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##       n notLegal legal
##   &lt;int&gt;    &lt;int&gt; &lt;int&gt;
## 1  1259      656   603</code></pre>
<p>We can finally proceed with our hypothesis test. Let’s use a significance level of <span class="math inline">\(\alpha = .05\)</span></p>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="inferential-statistics-take-2.html#cb585-1" tabindex="-1"></a>testResults <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(</span>
<span id="cb585-2"><a href="inferential-statistics-take-2.html#cb585-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">603</span></span>
<span id="cb585-3"><a href="inferential-statistics-take-2.html#cb585-3" tabindex="-1"></a>  , <span class="at">n =</span> <span class="dv">1259</span></span>
<span id="cb585-4"><a href="inferential-statistics-take-2.html#cb585-4" tabindex="-1"></a>  , <span class="at">p =</span> .<span class="dv">5</span></span>
<span id="cb585-5"><a href="inferential-statistics-take-2.html#cb585-5" tabindex="-1"></a>  , <span class="at">alternative =</span> <span class="st">&#39;less&#39;</span></span>
<span id="cb585-6"><a href="inferential-statistics-take-2.html#cb585-6" tabindex="-1"></a>  , <span class="at">conf.level =</span> .<span class="dv">95</span></span>
<span id="cb585-7"><a href="inferential-statistics-take-2.html#cb585-7" tabindex="-1"></a>  , <span class="at">correct =</span> F</span>
<span id="cb585-8"><a href="inferential-statistics-take-2.html#cb585-8" tabindex="-1"></a>)</span>
<span id="cb585-9"><a href="inferential-statistics-take-2.html#cb585-9" tabindex="-1"></a>testResults</span></code></pre></div>
<pre><code>## 
##  1-sample proportions test without continuity correction
## 
## data:  603 out of 1259, null probability 0.5
## X-squared = 2.2311, df = 1, p-value = 0.06763
## alternative hypothesis: true p is less than 0.5
## 95 percent confidence interval:
##  0.0000000 0.5021298
## sample estimates:
##         p 
## 0.4789515</code></pre>
<p>About 48% of the respondents in our sample believed that marijuana should be legalized. However, our p-value of 0.068 is greater than our significance level, so we fail to reject the null. In other words, we have no evidence that a minority of Americans supported marijuana legalization in 2010.</p>
</div>
</div>
<div id="two-sample-proportions" class="section level3 hasAnchor" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Two sample proportions<a href="inferential-statistics-take-2.html#two-sample-proportions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The main function we will use in this section is again <code>prop.test(...)</code>. In this section we will do one ‘toy’ example and one example using real-world data. The input and use is almost identical to that of performing single sample proportion inferences. The arguments/inputs are as follows.</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="inferential-statistics-take-2.html#cb587-1" tabindex="-1"></a><span class="fu">prop.test</span>(</span>
<span id="cb587-2"><a href="inferential-statistics-take-2.html#cb587-2" tabindex="-1"></a>  <span class="co"># x1 and x2 are the number of successes in sample 1 and 2</span></span>
<span id="cb587-3"><a href="inferential-statistics-take-2.html#cb587-3" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(x1, x2)  </span>
<span id="cb587-4"><a href="inferential-statistics-take-2.html#cb587-4" tabindex="-1"></a>  <span class="co"># n1 and n2 are the sizes of sample 1 and 2</span></span>
<span id="cb587-5"><a href="inferential-statistics-take-2.html#cb587-5" tabindex="-1"></a>  , <span class="at">n =</span> <span class="fu">c</span>(n1,n2)</span>
<span id="cb587-6"><a href="inferential-statistics-take-2.html#cb587-6" tabindex="-1"></a>  <span class="co"># leave p null when testing for a difference in proportion, our most common use</span></span>
<span id="cb587-7"><a href="inferential-statistics-take-2.html#cb587-7" tabindex="-1"></a>  , <span class="at">p =</span> <span class="cn">NULL</span></span>
<span id="cb587-8"><a href="inferential-statistics-take-2.html#cb587-8" tabindex="-1"></a>  , <span class="at">alternative =</span> <span class="co"># the type of hypothesis test to run corresponding to your alternative hypothesis; one of &quot;two.sided&quot;, &quot;less&quot;, or &quot;greater&quot;</span></span>
<span id="cb587-9"><a href="inferential-statistics-take-2.html#cb587-9" tabindex="-1"></a>  , <span class="at">conf.level =</span> <span class="co"># your confidence level as a decimal</span></span>
<span id="cb587-10"><a href="inferential-statistics-take-2.html#cb587-10" tabindex="-1"></a>  , <span class="at">correct =</span> <span class="cn">FALSE</span> <span class="co"># This turns OFF the Yates&#39; continuity correction so that calculations are made like we&#39;ve learned in class.</span></span>
<span id="cb587-11"><a href="inferential-statistics-take-2.html#cb587-11" tabindex="-1"></a>)</span></code></pre></div>
<p>The output of <code>prop.test</code> will look almost identical to when you perform a single sample inference and all of our cautions and commentary from the previous section apply in this section as well. First we’ll do a basic, made up example to see what the output looks like, then do an example with real data to practice interpreting the results.</p>
<p><strong>Basic, made up example</strong>: Suppose you have two samples, one with size <span class="math inline">\(n_1 = 344\)</span> and another with size <span class="math inline">\(n_2 = 432\)</span>. The first sample has 177 successes and the second has 124. You want check for a difference between the proportion of successes in populations 1 and 2. In other words, your hypothesis test is</p>
<p><span class="math display">\[\begin{array}{cc}
H_0: p_1 - p_2 = 0 \\
H_a: p_1 - p_2 \neq 0
\end{array}
    \]</span></p>
<p>The following code uses <code>prop.test</code> to perform this hypothesis test with a significance level of <span class="math inline">\(\alpha = .05\)</span></p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="inferential-statistics-take-2.html#cb588-1" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(</span>
<span id="cb588-2"><a href="inferential-statistics-take-2.html#cb588-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">177</span>, <span class="dv">124</span>)</span>
<span id="cb588-3"><a href="inferential-statistics-take-2.html#cb588-3" tabindex="-1"></a>  , <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">344</span>, <span class="dv">432</span>)</span>
<span id="cb588-4"><a href="inferential-statistics-take-2.html#cb588-4" tabindex="-1"></a>  , <span class="at">alternative =</span> <span class="st">&#39;two.sided&#39;</span></span>
<span id="cb588-5"><a href="inferential-statistics-take-2.html#cb588-5" tabindex="-1"></a>  , <span class="at">conf.level =</span> .<span class="dv">95</span></span>
<span id="cb588-6"><a href="inferential-statistics-take-2.html#cb588-6" tabindex="-1"></a>  , <span class="at">correct =</span> <span class="cn">FALSE</span></span>
<span id="cb588-7"><a href="inferential-statistics-take-2.html#cb588-7" tabindex="-1"></a>)</span>
<span id="cb588-8"><a href="inferential-statistics-take-2.html#cb588-8" tabindex="-1"></a>results</span></code></pre></div>
<pre><code>## 
##  2-sample test for equality of proportions without continuity correction
## 
## data:  c(177, 124) out of c(344, 432)
## X-squared = 41.744, df = 1, p-value = 1.04e-10
## alternative hypothesis: two.sided
## 95 percent confidence interval:
##  0.1596070 0.2953887
## sample estimates:
##    prop 1    prop 2 
## 0.5145349 0.2870370</code></pre>
<p>The printed <code>results</code> above give us all of the information we need. The <span class="math inline">\(p\)</span>-value of our test is <span class="math inline">\(1.0401892\times 10^{-10} &lt; \alpha = .05\)</span>, so the data provide compelling evidence of a difference between the population proportions.</p>
<p>How different are the two proportions you ask? Remember, that’s exactly what the confidence interval for a difference in proportions reports. In this case, it means that <span class="math inline">\(p_1 - p_2\)</span> lies between about 16% and 30% with 95% confidence. In other words, with 95% confidence, the proportion of successes in population 1 is between 16% and 30% higher than the proportion of successes in population 2.</p>
<div id="real-world-example" class="section level4 hasAnchor" number="7.1.2.1">
<h4><span class="header-section-number">7.1.2.1</span> “Real world” Example<a href="inferential-statistics-take-2.html#real-world-example" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this example we turn again to the <code>gss2010</code> data set from the <code>openintro</code> package and investigate another question about marijuana legalization opinion. After many years around colleges and universities, I hypothesize that, in general, people with college degrees have a different opinion on marijuana legalization than people without college degrees.</p>
<p>Let <span class="math inline">\(p_C\)</span> denote the proportion of Americans with college degrees who think marijuana should be legalized and let <span class="math inline">\(p_H\)</span> be the same proportion for Americans without college degrees. Our hypothesis test is then</p>
<p><span class="math display">\[\begin{array}{cc}
H_0: p_C - p_H = 0 \\
H_a: p_C - p_H \neq 0
\end{array}
    \]</span></p>
<p>We need to classify group the individuals in our sample into college degree recipients and non college degree recipients. The different levels of the <code>degree</code> factor are</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="inferential-statistics-take-2.html#cb590-1" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">unique</span>(gss2010<span class="sc">$</span>degree))</span></code></pre></div>
<pre><code>## [1] BACHELOR       GRADUATE       HIGH SCHOOL    JUNIOR COLLEGE LT HIGH SCHOOL
## Levels: BACHELOR GRADUATE HIGH SCHOOL JUNIOR COLLEGE LT HIGH SCHOOL</code></pre>
<p>so any individual whose degree level contains the string ‘HIGH SCHOOL’ does <em>not</em> have a college degree. Let’s add a column to our data set, then get the counts we need to perform our test. As in the example in the last section, we will drop the individuals who did not respond to the legalization question. To make the hypothesis test slightly easier to run, we will store the following summary table in memory.</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="inferential-statistics-take-2.html#cb592-1" tabindex="-1"></a>LegalizeIt <span class="ot">&lt;-</span> gss2010 <span class="sc">%&gt;%</span></span>
<span id="cb592-2"><a href="inferential-statistics-take-2.html#cb592-2" tabindex="-1"></a>  <span class="co">#drop rows with NA in grass column</span></span>
<span id="cb592-3"><a href="inferential-statistics-take-2.html#cb592-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(grass)) <span class="sc">%&gt;%</span></span>
<span id="cb592-4"><a href="inferential-statistics-take-2.html#cb592-4" tabindex="-1"></a>  <span class="co"># TRUE/FALSE binary for college degree</span></span>
<span id="cb592-5"><a href="inferential-statistics-take-2.html#cb592-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">collegeDegree =</span> <span class="sc">!</span><span class="fu">str_detect</span>(degree, <span class="st">&#39;HIGH SCHOOL&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb592-6"><a href="inferential-statistics-take-2.html#cb592-6" tabindex="-1"></a>  <span class="fu">group_by</span>(collegeDegree) <span class="sc">%&gt;%</span></span>
<span id="cb592-7"><a href="inferential-statistics-take-2.html#cb592-7" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb592-8"><a href="inferential-statistics-take-2.html#cb592-8" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb592-9"><a href="inferential-statistics-take-2.html#cb592-9" tabindex="-1"></a>    , <span class="at">legal =</span> <span class="fu">sum</span>(grass <span class="sc">==</span> <span class="st">&#39;LEGAL&#39;</span>)</span>
<span id="cb592-10"><a href="inferential-statistics-take-2.html#cb592-10" tabindex="-1"></a>    , <span class="at">notLegal =</span> <span class="fu">sum</span>(grass <span class="sc">==</span> <span class="st">&#39;NOT LEGAL&#39;</span>)</span>
<span id="cb592-11"><a href="inferential-statistics-take-2.html#cb592-11" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb592-12"><a href="inferential-statistics-take-2.html#cb592-12" tabindex="-1"></a>  <span class="co">#arrange the results so that collegeDegree = TRUE comes first. </span></span>
<span id="cb592-13"><a href="inferential-statistics-take-2.html#cb592-13" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(collegeDegree))</span>
<span id="cb592-14"><a href="inferential-statistics-take-2.html#cb592-14" tabindex="-1"></a>LegalizeIt</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   collegeDegree     n legal notLegal
##   &lt;lgl&gt;         &lt;int&gt; &lt;int&gt;    &lt;int&gt;
## 1 TRUE            453   234      219
## 2 FALSE           806   369      437</code></pre>
<p>Now we are ready to perform our hypothesis test with <code>prop.test</code> and a significance level of <span class="math inline">\(\alpha = .05\)</span>.</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="inferential-statistics-take-2.html#cb594-1" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">prop.test</span>(</span>
<span id="cb594-2"><a href="inferential-statistics-take-2.html#cb594-2" tabindex="-1"></a>  <span class="at">x =</span> LegalizeIt<span class="sc">$</span>legal</span>
<span id="cb594-3"><a href="inferential-statistics-take-2.html#cb594-3" tabindex="-1"></a>  , <span class="at">n =</span> LegalizeIt<span class="sc">$</span>n</span>
<span id="cb594-4"><a href="inferential-statistics-take-2.html#cb594-4" tabindex="-1"></a>  , <span class="at">p =</span> <span class="cn">NULL</span></span>
<span id="cb594-5"><a href="inferential-statistics-take-2.html#cb594-5" tabindex="-1"></a>  , <span class="at">alternative =</span> <span class="st">&#39;two.sided&#39;</span></span>
<span id="cb594-6"><a href="inferential-statistics-take-2.html#cb594-6" tabindex="-1"></a>  , <span class="at">conf.level =</span> .<span class="dv">95</span></span>
<span id="cb594-7"><a href="inferential-statistics-take-2.html#cb594-7" tabindex="-1"></a>  , <span class="at">correct =</span> <span class="cn">FALSE</span></span>
<span id="cb594-8"><a href="inferential-statistics-take-2.html#cb594-8" tabindex="-1"></a>)</span>
<span id="cb594-9"><a href="inferential-statistics-take-2.html#cb594-9" tabindex="-1"></a>results </span></code></pre></div>
<pre><code>## 
##  2-sample test for equality of proportions without continuity correction
## 
## data:  LegalizeIt$legal out of LegalizeIt$n
## X-squared = 4.0096, df = 1, p-value = 0.04524
## alternative hypothesis: two.sided
## 95 percent confidence interval:
##  0.001287983 0.116191845
## sample estimates:
##    prop 1    prop 2 
## 0.5165563 0.4578164</code></pre>
<p>The p-value of our test is 0.045 which just squeezes in under <span class="math inline">\(\alpha = .05\)</span>, so we have statistically significant evidence that there is a difference in opinion on marijuana legalization between those with and without college degrees.</p>
<p>We can use the confidence interval from our results to be a bit more specific. At the 95% confidence level, the proportion of people with college degrees who think marijuana should be legalized is between 0.1% and 11.6% higher than the proportion of people without college degrees.</p>
<p>Remember, this was all calculated using 2010 data, so you may want to redo this investigation with more up-to-date information.</p>
</div>
</div>
<div id="chi-squared-goodness-of-fit-test" class="section level3 hasAnchor" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> Chi-squared goodness of fit test<a href="inferential-statistics-take-2.html#chi-squared-goodness-of-fit-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="chi-squared-test-of-independence-1" class="section level3 hasAnchor" number="7.1.4">
<h3><span class="header-section-number">7.1.4</span> Chi-squared test of independence<a href="inferential-statistics-take-2.html#chi-squared-test-of-independence-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="analyzing-numerical-variables-1" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Analyzing numerical variables<a href="inferential-statistics-take-2.html#analyzing-numerical-variables-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="single-sample-mean-1" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Single sample mean<a href="inferential-statistics-take-2.html#single-sample-mean-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="two-sample-mean-1" class="section level3 hasAnchor" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Two sample mean<a href="inferential-statistics-take-2.html#two-sample-mean-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="paired-data-1" class="section level3 hasAnchor" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Paired data<a href="inferential-statistics-take-2.html#paired-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="analysis-of-variance-anova-1" class="section level3 hasAnchor" number="7.2.4">
<h3><span class="header-section-number">7.2.4</span> Analysis of variance (ANOVA)<a href="inferential-statistics-take-2.html#analysis-of-variance-anova-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="inferential-statistics-take-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modeling-relationships.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/06-inference_pt2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
