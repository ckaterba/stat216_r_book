<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Wrangling data | R and RStudio for STAT216</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Wrangling data | R and RStudio for STAT216" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Wrangling data | R and RStudio for STAT216" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Charles Katerba" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cross.html"/>
<link rel="next" href="distribution-calculations.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for STAT216 @ FVCC</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#organization"><i class="fa fa-check"></i><b>1.1</b> Organization</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#getting-started"><i class="fa fa-check"></i><b>1.2</b> Getting started</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#code-in-this-book"><i class="fa fa-check"></i><b>1.3</b> Code in this book</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#help"><i class="fa fa-check"></i><b>1.4</b> Help</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#debugging"><i class="fa fa-check"></i><b>1.5</b> Debugging</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#other-resources"><i class="fa fa-check"></i><b>1.6</b> Other resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rstudio-basics.html"><a href="rstudio-basics.html"><i class="fa fa-check"></i><b>2</b> RStudio basics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rstudio-basics.html"><a href="rstudio-basics.html#a-big-calculator"><i class="fa fa-check"></i><b>2.1</b> A big calculator</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="rstudio-basics.html"><a href="rstudio-basics.html#numbers"><i class="fa fa-check"></i><b>2.1.1</b> Numbers</a></li>
<li class="chapter" data-level="2.1.2" data-path="rstudio-basics.html"><a href="rstudio-basics.html#strings"><i class="fa fa-check"></i><b>2.1.2</b> Strings</a></li>
<li class="chapter" data-level="2.1.3" data-path="rstudio-basics.html"><a href="rstudio-basics.html#logicals-and-logical-operators"><i class="fa fa-check"></i><b>2.1.3</b> Logicals and Logical operators</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="rstudio-basics.html"><a href="rstudio-basics.html#naming-things"><i class="fa fa-check"></i><b>2.2</b> Naming things</a></li>
<li class="chapter" data-level="2.3" data-path="rstudio-basics.html"><a href="rstudio-basics.html#lists-and-vectors"><i class="fa fa-check"></i><b>2.3</b> Lists and vectors</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="rstudio-basics.html"><a href="rstudio-basics.html#creating-lists"><i class="fa fa-check"></i><b>2.3.1</b> Creating lists</a></li>
<li class="chapter" data-level="2.3.2" data-path="rstudio-basics.html"><a href="rstudio-basics.html#subsetting-lists"><i class="fa fa-check"></i><b>2.3.2</b> Subsetting lists</a></li>
<li class="chapter" data-level="2.3.3" data-path="rstudio-basics.html"><a href="rstudio-basics.html#special-lists"><i class="fa fa-check"></i><b>2.3.3</b> Special lists</a></li>
<li class="chapter" data-level="2.3.4" data-path="rstudio-basics.html"><a href="rstudio-basics.html#list-arithmetic"><i class="fa fa-check"></i><b>2.3.4</b> List arithmetic</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="rstudio-basics.html"><a href="rstudio-basics.html#packages"><i class="fa fa-check"></i><b>2.4</b> Packages</a></li>
<li class="chapter" data-level="2.5" data-path="rstudio-basics.html"><a href="rstudio-basics.html#data-frames-and-tibbles"><i class="fa fa-check"></i><b>2.5</b> Data frames and tibbles</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="rstudio-basics.html"><a href="rstudio-basics.html#creating-data-frames"><i class="fa fa-check"></i><b>2.5.1</b> Creating data frames</a></li>
<li class="chapter" data-level="2.5.2" data-path="rstudio-basics.html"><a href="rstudio-basics.html#using-data-frames"><i class="fa fa-check"></i><b>2.5.2</b> Using data frames</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="rstudio-basics.html"><a href="rstudio-basics.html#r-markdown-documents"><i class="fa fa-check"></i><b>2.6</b> R Markdown documents</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cross.html"><a href="cross.html"><i class="fa fa-check"></i><b>3</b> Summary statistics and data visualization</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cross.html"><a href="cross.html#summary-statistics-in-r"><i class="fa fa-check"></i><b>3.1</b> Summary statistics in R</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="cross.html"><a href="cross.html#numerical-variables"><i class="fa fa-check"></i><b>3.1.1</b> Numerical variables</a></li>
<li class="chapter" data-level="3.1.2" data-path="cross.html"><a href="cross.html#categorical-variables"><i class="fa fa-check"></i><b>3.1.2</b> Categorical variables</a></li>
<li class="chapter" data-level="3.1.3" data-path="cross.html"><a href="cross.html#combining-it-all"><i class="fa fa-check"></i><b>3.1.3</b> Combining it all</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="cross.html"><a href="cross.html#data-visualization"><i class="fa fa-check"></i><b>3.2</b> Data visualization</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="cross.html"><a href="cross.html#base-r"><i class="fa fa-check"></i><b>3.2.1</b> Base R</a></li>
<li class="chapter" data-level="3.2.2" data-path="cross.html"><a href="cross.html#ggplot2"><i class="fa fa-check"></i><b>3.2.2</b> <code>ggplot2</code></a></li>
<li class="chapter" data-level="3.2.3" data-path="cross.html"><a href="cross.html#saving-plots"><i class="fa fa-check"></i><b>3.2.3</b> Saving plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="wrangling-data.html"><a href="wrangling-data.html"><i class="fa fa-check"></i><b>4</b> Wrangling data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="wrangling-data.html"><a href="wrangling-data.html#the-goal-tidy-data."><i class="fa fa-check"></i><b>4.1</b> The goal: “tidy” data.</a></li>
<li class="chapter" data-level="4.2" data-path="wrangling-data.html"><a href="wrangling-data.html#the-pipe"><i class="fa fa-check"></i><b>4.2</b> The pipe</a></li>
<li class="chapter" data-level="4.3" data-path="wrangling-data.html"><a href="wrangling-data.html#common-tidying-operations"><i class="fa fa-check"></i><b>4.3</b> Common tidying operations</a></li>
<li class="chapter" data-level="4.4" data-path="wrangling-data.html"><a href="wrangling-data.html#mutate-group-by-and-summarize"><i class="fa fa-check"></i><b>4.4</b> Mutate, group by, and summarize</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="distribution-calculations.html"><a href="distribution-calculations.html"><i class="fa fa-check"></i><b>5</b> Distribution calculations</a>
<ul>
<li class="chapter" data-level="5.1" data-path="distribution-calculations.html"><a href="distribution-calculations.html#finite-discrte-distribution-calculations"><i class="fa fa-check"></i><b>5.1</b> Finite discrte distribution calculations</a></li>
<li class="chapter" data-level="5.2" data-path="distribution-calculations.html"><a href="distribution-calculations.html#named-distribution-calculations"><i class="fa fa-check"></i><b>5.2</b> Named distribution calculations</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="distribution-calculations.html"><a href="distribution-calculations.html#discrete-random-variables"><i class="fa fa-check"></i><b>5.2.1</b> Discrete random variables</a></li>
<li class="chapter" data-level="5.2.2" data-path="distribution-calculations.html"><a href="distribution-calculations.html#continuous-random-variables"><i class="fa fa-check"></i><b>5.2.2</b> Continuous random variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html"><i class="fa fa-check"></i><b>6</b> Inferential statistics, take 1</a></li>
<li class="chapter" data-level="7" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html"><i class="fa fa-check"></i><b>7</b> Inferential statistics, take 2</a>
<ul>
<li class="chapter" data-level="7.1" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#analyzing-categorical-variables"><i class="fa fa-check"></i><b>7.1</b> Analyzing categorical variables</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#single-sample"><i class="fa fa-check"></i><b>7.1.1</b> Single sample</a></li>
<li class="chapter" data-level="7.1.2" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#two-sample"><i class="fa fa-check"></i><b>7.1.2</b> Two sample</a></li>
<li class="chapter" data-level="7.1.3" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#chi-squared-goodness-of-fit-test"><i class="fa fa-check"></i><b>7.1.3</b> Chi-squared goodness of fit test</a></li>
<li class="chapter" data-level="7.1.4" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#chi-squared-test-of-independence"><i class="fa fa-check"></i><b>7.1.4</b> Chi-squared test of independence</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#analyzing-numerical-variables"><i class="fa fa-check"></i><b>7.2</b> Analyzing numerical variables</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#single-sample-mean"><i class="fa fa-check"></i><b>7.2.1</b> Single sample mean</a></li>
<li class="chapter" data-level="7.2.2" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#two-sample-mean"><i class="fa fa-check"></i><b>7.2.2</b> Two sample mean</a></li>
<li class="chapter" data-level="7.2.3" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#paired-data"><i class="fa fa-check"></i><b>7.2.3</b> Paired data</a></li>
<li class="chapter" data-level="7.2.4" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#analysis-of-variance-anova"><i class="fa fa-check"></i><b>7.2.4</b> Analysis of variance (ANOVA)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modeling-relationships.html"><a href="modeling-relationships.html"><i class="fa fa-check"></i><b>8</b> Modeling relationships</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modeling-relationships.html"><a href="modeling-relationships.html#simple-linear-regression"><i class="fa fa-check"></i><b>8.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="8.2" data-path="modeling-relationships.html"><a href="modeling-relationships.html#multiple-linear-regression"><i class="fa fa-check"></i><b>8.2</b> Multiple linear regression</a></li>
<li class="chapter" data-level="8.3" data-path="modeling-relationships.html"><a href="modeling-relationships.html#bonus-topic-logistic-regression"><i class="fa fa-check"></i><b>8.3</b> Bonus topic: logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R and RStudio for STAT216</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="wrangling-data" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Wrangling data<a href="wrangling-data.html#wrangling-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>“Wrangling data” is a term used to describe the processes of manipulating or transforming raw data into a format that is easier to analyze and use. Data professionals often spend large chunks of time on the data wrangling phase of a project since the analysis and use flows much more smoothly when the wrangling is done appropriately. Like most chapters in this book, we won’t go too in depth into this subject, but we will cover enough to get you started. In particular, this section aims to</p>
<ul>
<li><p>help you understand what the end goal of data wrangling might look like. In other words, start understanding what a good, easy to use data set might look like.</p></li>
<li><p>be able to use R’s <code>tidyverse</code> package to perform some basic data wrangling tasks.</p></li>
</ul>
<p>This section of notes will can be thought of as a condensed version of the <em>Wrangle</em> and <em>Program</em> sections of <a href="https://r4ds.had.co.nz/tidy-data.html">R for Data Science</a> and references this book substantially.</p>
<p>Remember, since we’re using the <code>tidyverse</code> package in this section, you have to load the package with</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="wrangling-data.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div id="the-goal-tidy-data." class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> The goal: “tidy” data.<a href="wrangling-data.html#the-goal-tidy-data." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the early days of STAT216, we stipulated that data sets should contain variables in columns and observations in rows. This is the common convention in data science, but this convention is not always followed, especially when you’re collecting data from out in the wild. This can come about for a myriad of reasons, but one common reason you’ll encounter “unconventional data organization” is that the data enter prioritizes human-readability over machine-readability and ease of analysis.</p>
<p>For example, suppose you were giving a blind taste test of three types of diet cola: diet Coke, diet Pepsi, and diet RC. You give 3 groups of 10 random people a drink and ask them to rate their preference on a scale of 1-5 with 5 being great and 1 being awful. A natural way to organize the data from your experiment may look something like the table below (the numbers are randomly generated).</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="wrangling-data.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1123</span>)</span>
<span id="cb244-2"><a href="wrangling-data.html#cb244-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>( <span class="at">coke =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">replace =</span> T), </span>
<span id="cb244-3"><a href="wrangling-data.html#cb244-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">pepsi =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">replace =</span> T), </span>
<span id="cb244-4"><a href="wrangling-data.html#cb244-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">rc =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">replace =</span> T))  <span class="co">#generate table of random numbers.</span></span>
<span id="cb244-5"><a href="wrangling-data.html#cb244-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-6"><a href="wrangling-data.html#cb244-6" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">coke</th>
<th align="right">pepsi</th>
<th align="right">rc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">3</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">4</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">5</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">5</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">4</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
<p>Note, however, that the drink someone is tasting is actually a variable! This means our data set doesn’t have variables in columns, it splits one variable up into three different columns. This type of thing is quite common. Fortunately, R gives us a way to easily transform such data sets as we’ll see. The appropriate format for our convention of variables in columns, observations in rows would be</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="wrangling-data.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1123</span>) <span class="co"># make sure random numbers generated above are the same. </span></span>
<span id="cb245-2"><a href="wrangling-data.html#cb245-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-3"><a href="wrangling-data.html#cb245-3" aria-hidden="true" tabindex="-1"></a>dfTidy <span class="ot">&lt;-</span> <span class="fu">tibble</span>( <span class="co">#first a column of the drink participants had</span></span>
<span id="cb245-4"><a href="wrangling-data.html#cb245-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">drink =</span>  <span class="fu">c</span>( <span class="fu">rep</span>(<span class="st">&quot;coke&quot;</span>, <span class="dv">10</span>), <span class="fu">rep</span>(<span class="st">&quot;pepsi&quot;</span>, <span class="dv">10</span>), <span class="fu">rep</span>(<span class="st">&quot;rc&quot;</span>, <span class="dv">10</span>)), </span>
<span id="cb245-5"><a href="wrangling-data.html#cb245-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># then a column of their scores</span></span>
<span id="cb245-6"><a href="wrangling-data.html#cb245-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">score =</span> <span class="fu">c</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">replace =</span> T), </span>
<span id="cb245-7"><a href="wrangling-data.html#cb245-7" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">replace =</span> T),</span>
<span id="cb245-8"><a href="wrangling-data.html#cb245-8" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">replace =</span> T) ))</span>
<span id="cb245-9"><a href="wrangling-data.html#cb245-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dfTidy)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   drink score
##   &lt;chr&gt; &lt;int&gt;
## 1 coke      3
## 2 coke      4
## 3 coke      4
## 4 coke      1
## 5 coke      3
## 6 coke      4</code></pre>
<p>This data set is less easy to read as a human (since it has 30 rows and two columns), but is much easier to analyze in R (and pretty much all other available software).</p>
<p>This example typifies our goal of <strong>tidy data</strong>:</p>
<ol style="list-style-type: decimal">
<li><p>Each variable should have its own column.</p></li>
<li><p>Each observation/observational unit should have its own row.</p></li>
</ol>
<p>Again, the purpose of <strong>tidy data</strong> is to streamline and make the analysis stage of your data journey easier. Most functionality in R is substantially easier to implement when you start with a tidy data set.</p>
<p>As an example, if we’d like to make side-by-side box plots of the results of our cola taste test using the original data set <code>df</code> in <code>ggplot2</code>, we might try something like</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="wrangling-data.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> ???, <span class="at">y =</span> ???)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p>but run into an immediate problem. What is the <span class="math inline">\(x\)</span> variable? What is the <span class="math inline">\(y\)</span>? If we use the tidy version of the same data, the answer is clear however: <span class="math inline">\(x\)</span> is the drink, <span class="math inline">\(y\)</span> is the score, since drink is the explanatory variable and taste preference is the response. Using <code>dfTidy</code> from above instead, we’d simply use the following.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="wrangling-data.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfTidy, <span class="fu">aes</span>(<span class="at">x =</span> drink, <span class="at">y =</span> score)) <span class="sc">+</span> </span>
<span id="cb248-2"><a href="wrangling-data.html#cb248-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-94-1.png" width="672" /></p>
<p>Essentially <em>all</em> tools in the <code>tidyverse</code> package are designed around having tidy data. In the next section, we’ll learn about one of the main functions from the <code>tidyverse</code> package used in tidying and analyzing data, the pipe.</p>
</div>
<div id="the-pipe" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> The pipe<a href="wrangling-data.html#the-pipe" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The pipe, typed as <code>%&gt;%</code>, is a function from the <code>tidyverse</code> package whose intention is to make a sequence of transformations or operations on a data set more clear and easier for humans to follow and write. In some sense, you can think of it as adding layers of transformations to a data set, just like you use the <code>+</code> function to add layers to a graph in <code>ggplot2</code>. Note: this analogy is by design from the nice folks who created the <code>tidyverse</code>!</p>
<p>In essence, the pipe tells R to do the operation on the <em>right</em> side of the pipe to the data set on the left of it; if there are multiple pipes in a sequence, they are evaluated left to right/top to bottom. Let’s try an example to see how it works.</p>
<p>We’ll start with the <code>dfTidy</code> data from above. Suppose we forgot to add the results from a blind taste test of Diet Dr. Pepper. We load that data into R (simulating it of course in this case)</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="wrangling-data.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1123</span>)</span>
<span id="cb249-2"><a href="wrangling-data.html#cb249-2" aria-hidden="true" tabindex="-1"></a>dp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">drink =</span> <span class="fu">rep</span>(<span class="st">&quot;dp&quot;</span>, <span class="dv">10</span>),</span>
<span id="cb249-3"><a href="wrangling-data.html#cb249-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">score =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p>Now suppose want to</p>
<ol style="list-style-type: decimal">
<li><p>Add this data to <code>dfTidy</code>.</p></li>
<li><p>Add a new column that rescales the scores so that they’re between 0 and 1 instead of 1 and 5.</p></li>
</ol>
<p>We can do this quickly using the following</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="wrangling-data.html#cb250-1" aria-hidden="true" tabindex="-1"></a>newDf <span class="ot">&lt;-</span> dfTidy <span class="sc">%&gt;%</span> <span class="co">#start with dfTidy</span></span>
<span id="cb250-2"><a href="wrangling-data.html#cb250-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(dp) <span class="sc">%&gt;%</span> <span class="co">#adds dp to the bottom of dfTidy</span></span>
<span id="cb250-3"><a href="wrangling-data.html#cb250-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">newScale =</span> .<span class="dv">25</span><span class="sc">*</span>score <span class="sc">-</span> .<span class="dv">25</span>) <span class="co">#add new column to whole dataset. </span></span></code></pre></div>
<p>To see that this did what we hope, let’s look at a random sample of 10 rows using the <code>slice_sample</code> function</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="wrangling-data.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1123</span>) </span>
<span id="cb251-2"><a href="wrangling-data.html#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="co">#more piping!</span></span>
<span id="cb251-3"><a href="wrangling-data.html#cb251-3" aria-hidden="true" tabindex="-1"></a>newDf <span class="sc">%&gt;%</span> </span>
<span id="cb251-4"><a href="wrangling-data.html#cb251-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 x 3
##    drink score newScale
##    &lt;chr&gt; &lt;int&gt;    &lt;dbl&gt;
##  1 dp        2     0.25
##  2 coke      1     0   
##  3 pepsi     1     0   
##  4 dp        4     0.75
##  5 dp        3     0.5 
##  6 dp        3     0.5 
##  7 rc        3     0.5 
##  8 rc        2     0.25
##  9 coke      2     0.25
## 10 dp        1     0</code></pre>
<p>It does as we’d hoped! Great. You may be wondering <em>why</em> piping exists. Earlier we said it was to make code easier to read and intuitive to write. But with respect to what? There are two older programming conventions that piping is trying to clarify: “overwriting the original” and “function composition”. Let’s create <code>dfTidy</code> using these two strategies.</p>
<p><strong>Overwriting the original</strong>: At each stage, overwrite what you did at the previous stage. It’s not too bad in this example, but can be tedious if you have say 10 different transformations to make. It is especially inconvenient if you need to make changes since you have to track those changes through all your steps.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="wrangling-data.html#cb253-1" aria-hidden="true" tabindex="-1"></a>newDf1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(dfTidy, dp)</span>
<span id="cb253-2"><a href="wrangling-data.html#cb253-2" aria-hidden="true" tabindex="-1"></a>newDf1 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(newDf1, <span class="at">newScale =</span> .<span class="dv">25</span><span class="sc">*</span>score <span class="sc">-</span> .<span class="dv">25</span>)</span>
<span id="cb253-3"><a href="wrangling-data.html#cb253-3" aria-hidden="true" tabindex="-1"></a><span class="co">#check to see we got the same thing</span></span>
<span id="cb253-4"><a href="wrangling-data.html#cb253-4" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(newDf, newDf1)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p><strong>Function composition</strong>: This is probably the least human readable way to write create our new data set, but it also makes explicit what the computer is doing and it looks shorter. Notice that you have to read from the inside out and right to left. Once again, this isn’t too bad with only two transformations, but you could imagine how much of a nightmare this could be with 10 transformations, especially in terms of reading the code.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="wrangling-data.html#cb255-1" aria-hidden="true" tabindex="-1"></a>newDf2 <span class="ot">&lt;-</span> <span class="fu">mutate</span>( <span class="fu">bind_rows</span>(dfTidy, dp), <span class="at">newScale =</span> .<span class="dv">25</span><span class="sc">*</span>score <span class="sc">-</span> .<span class="dv">25</span>)</span>
<span id="cb255-2"><a href="wrangling-data.html#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="co">#are they equal? </span></span>
<span id="cb255-3"><a href="wrangling-data.html#cb255-3" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>(newDf, newDf2)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Hopefully you think the piped sequence of transformations is more straightforward to read and write than the other two options.</p>
<p>Now that we’re more comfortable with the pipe, let’s use it to implement some common forms of transformations!</p>
</div>
<div id="common-tidying-operations" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Common tidying operations<a href="wrangling-data.html#common-tidying-operations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you’re dealing with a data set that isn’t tidy, it typically violates our <em>tidy</em> criteria in one of two ways:</p>
<ol style="list-style-type: decimal">
<li><p>Variables can be split across several columns. In this case, the column names are not variable names, but <em>values</em> of a variable like the original data set for our diet cola blind taste test <code>df</code> above.</p></li>
<li><p>Observations can be split across several rows.</p></li>
</ol>
<p>There are two functions in the <code>tidyverse</code> used to handle these cases: <code>pivot_longer(...)</code> and <code>pivot_wider(...)</code>. <strong>Caution</strong>: it can take a little bit of time get these functions to do exactly what you want. Have a bit of patience and you’ll improve with time!</p>
<p>The function <code>pivot_longer(...)</code> is used to tidy a data set when variables are split across several columns; it takes the <em>values</em> of the variable that are the untidy column names, makes a new column for them, then organizes the values of the columns appropriately. This is best observed in an example: instead of reentering the data in our cola example, we could instead use pivot longer.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="wrangling-data.html#cb257-1" aria-hidden="true" tabindex="-1"></a>dfTidy1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb257-2"><a href="wrangling-data.html#cb257-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#specify the columns are actually values</span></span>
<span id="cb257-3"><a href="wrangling-data.html#cb257-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;coke&quot;</span>, <span class="st">&quot;pepsi&quot;</span>, <span class="st">&quot;rc&quot;</span>),  </span>
<span id="cb257-4"><a href="wrangling-data.html#cb257-4" aria-hidden="true" tabindex="-1"></a>               <span class="co">#then specify column/variable name</span></span>
<span id="cb257-5"><a href="wrangling-data.html#cb257-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;drink&quot;</span>,</span>
<span id="cb257-6"><a href="wrangling-data.html#cb257-6" aria-hidden="true" tabindex="-1"></a>               <span class="co">#finally specify the name of the values</span></span>
<span id="cb257-7"><a href="wrangling-data.html#cb257-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;score&quot;</span></span>
<span id="cb257-8"><a href="wrangling-data.html#cb257-8" aria-hidden="true" tabindex="-1"></a>               )</span>
<span id="cb257-9"><a href="wrangling-data.html#cb257-9" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(dfTidy1)</span></code></pre></div>
<pre><code>## Rows: 30
## Columns: 2
## $ drink &lt;chr&gt; &quot;coke&quot;, &quot;pepsi&quot;, &quot;rc&quot;, &quot;coke&quot;, &quot;pepsi&quot;, &quot;rc&quot;, &quot;coke&quot;, &quot;pep~
## $ score &lt;int&gt; 3, 3, 1, 4, 2, 1, 4, 3, 2, 1, 4, 3, 3, 4, 5, 4, 1, 2, 1, 5~</code></pre>
<p>At first it doesn’t seem like this data set is the same as <code>dfTidy</code>, but notice that R arranged the values as “coke”, “pepsi”, “rc”. If we rearrange the rows alphabetically by drink, we’ll see that they are in fact that same data sets.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="wrangling-data.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all.equal</span>( dfTidy <span class="sc">%&gt;%</span> </span>
<span id="cb259-2"><a href="wrangling-data.html#cb259-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">arrange</span>(drink), </span>
<span id="cb259-3"><a href="wrangling-data.html#cb259-3" aria-hidden="true" tabindex="-1"></a>           dfTidy1<span class="sc">%&gt;%</span> </span>
<span id="cb259-4"><a href="wrangling-data.html#cb259-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">arrange</span>(drink))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>The function <code>pivot_wider(...)</code> is used to tidy a data set when observations are split across several rows. The <code>tidyverse</code> has a data set simply called <code>table2</code> that provides an example of observations being split across several rows. This table shows “the number of TB cases documented by the World Health Organization in Afghanistan, Brazil, and China between 1999 and 2000” (from the documentation).</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="wrangling-data.html#cb261-1" aria-hidden="true" tabindex="-1"></a>table2</span></code></pre></div>
<pre><code>## # A tibble: 12 x 4
##    country      year type            count
##    &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;           &lt;int&gt;
##  1 Afghanistan  1999 cases             745
##  2 Afghanistan  1999 population   19987071
##  3 Afghanistan  2000 cases            2666
##  4 Afghanistan  2000 population   20595360
##  5 Brazil       1999 cases           37737
##  6 Brazil       1999 population  172006362
##  7 Brazil       2000 cases           80488
##  8 Brazil       2000 population  174504898
##  9 China        1999 cases          212258
## 10 China        1999 population 1272915272
## 11 China        2000 cases          213766
## 12 China        2000 population 1280428583</code></pre>
<p>In this example, the observations are a country in a year, so <code>cases</code> and <code>population</code> are not <em>values</em>. Instead, they are variables, since in a given year each country has a population and a certain number of TB cases.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="wrangling-data.html#cb263-1" aria-hidden="true" tabindex="-1"></a>table2 <span class="sc">%&gt;%</span></span>
<span id="cb263-2"><a href="wrangling-data.html#cb263-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#first specify where the new column names are coming from</span></span>
<span id="cb263-3"><a href="wrangling-data.html#cb263-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;type&quot;</span>, </span>
<span id="cb263-4"><a href="wrangling-data.html#cb263-4" aria-hidden="true" tabindex="-1"></a>              <span class="co">#next specify where the new column values are coming from</span></span>
<span id="cb263-5"><a href="wrangling-data.html#cb263-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="st">&quot;count&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country      year  cases population
##   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
<p>Much better! Notice that the same information is displayed in both tables. The latter option is simply easier to work with.</p>
</div>
<div id="mutate-group-by-and-summarize" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Mutate, group by, and summarize<a href="wrangling-data.html#mutate-group-by-and-summarize" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Once you’re working with a tidy data set, you may want to add columns to it, create a summary of the data, or both. The key functions for performing these operations are <code>mutate(...)</code>, <code>group_by(...)</code>, <code>summarize(...)</code>, and <code>transmute(...)</code>, all of which are from the <code>dplyr</code> package, which is part of the <code>tidyverse</code>. Before looking at specific examples of these functions in action, we’ll define what they do.</p>
<ul>
<li><p><code>mutate(...)</code> adds columns to an existing data set and keeps the old columns.</p></li>
<li><p><code>transmute(...)</code> creates new columns from a data set, but drops the old existing columns.</p></li>
<li><p><code>group_by(...)</code> takes column names as input and converts your data set to a “grouped” table. This means all operations and summary/aggregate functions are performed by group. The groups are defined by the values in the columns you specified.</p></li>
<li><p><code>summarize(...)</code> creates a new data set giving a customized summary of your data set. All operations are done by the grouping variables.</p></li>
</ul>
<p>For examples of each function, we will use the <code>gss2010</code> data set, which is part of the <code>openintro</code> package. As a reminder, to follow along you need to attach this package with</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="wrangling-data.html#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openintro)</span>
<span id="cb265-2"><a href="wrangling-data.html#cb265-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gss2010)</span></code></pre></div>
<p>The <code>gss2010</code> data set has 2044 measurements of 5 varibles:</p>
<ul>
<li><p><code>hrsrelax</code>: hours relaxed after work on an average work day.</p></li>
<li><p><code>mntlhlth</code>: number of days in the last month where mental health was not good.</p></li>
<li><p><code>hrs1</code>: weekly hours worked.</p></li>
<li><p><code>degree</code>: highest educational attainment or degree.</p></li>
<li><p><code>grass</code>: Should marijuana be legalized?</p></li>
</ul>
<p>Working with this data set provides an obstacle that we haven’t encountered much so far in these notes: <code>NA</code> values. A quick glimpse at the data reveals that there are quite a few missing values. In learning how to use the functions listed above, we’ll also see a few strategies for dealing with missing values.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="wrangling-data.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(gss2010)</span></code></pre></div>
<pre><code>## Rows: 2,044
## Columns: 5
## $ hrsrelax &lt;int&gt; 2, 4, NA, NA, NA, NA, 3, NA, 0, 5, 5, NA, 3, NA, NA, NA~
## $ mntlhlth &lt;int&gt; 3, 6, NA, NA, NA, NA, 0, NA, 0, 10, 0, NA, 0, NA, NA, N~
## $ hrs1     &lt;int&gt; 55, 45, NA, NA, NA, NA, 45, NA, 40, 48, 26, NA, 40, NA,~
## $ degree   &lt;fct&gt; BACHELOR, BACHELOR, LT HIGH SCHOOL, LT HIGH SCHOOL, LT ~
## $ grass    &lt;fct&gt; NA, LEGAL, NA, NOT LEGAL, NOT LEGAL, LEGAL, NA, NA, NOT~</code></pre>
<p>First, let’s add a new column to our data set that gives the total number of hours each person in this survey spend at work or relaxing and another column that reports the proportion of their time spent working or relaxing Monday through Friday. Note that since <code>hrsrelax</code> gives the number of hours they relax in a day, we should add 5 times that amount for total time spent relaxing during the work work.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="wrangling-data.html#cb268-1" aria-hidden="true" tabindex="-1"></a>new_gss <span class="ot">&lt;-</span> gss2010 <span class="sc">%&gt;%</span></span>
<span id="cb268-2"><a href="wrangling-data.html#cb268-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">totalHours =</span> <span class="dv">5</span><span class="sc">*</span>hrsrelax <span class="sc">+</span> hrs1, <span class="co">#hours spent working and relaxing</span></span>
<span id="cb268-3"><a href="wrangling-data.html#cb268-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">propTimeWorking =</span> totalHours<span class="sc">/</span>(<span class="dv">5</span><span class="sc">*</span><span class="dv">24</span>)) <span class="co">#proportion of time spent working/relaxing</span></span>
<span id="cb268-4"><a href="wrangling-data.html#cb268-4" aria-hidden="true" tabindex="-1"></a><span class="co"># random sample of 7 rows from the data set</span></span>
<span id="cb268-5"><a href="wrangling-data.html#cb268-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>( <span class="fu">slice_sample</span>(new_gss, <span class="at">n =</span> <span class="dv">7</span>) ) </span></code></pre></div>
<pre><code>## Rows: 7
## Columns: 7
## $ hrsrelax        &lt;int&gt; 4, 6, 6, NA, NA, 7, NA
## $ mntlhlth        &lt;int&gt; 0, 0, 2, NA, NA, 0, NA
## $ hrs1            &lt;int&gt; 55, 35, 9, NA, NA, 20, NA
## $ degree          &lt;fct&gt; LT HIGH SCHOOL, HIGH SCHOOL, LT HIGH SCHOOL, HIG~
## $ grass           &lt;fct&gt; NOT LEGAL, NA, LEGAL, NA, NA, NA, LEGAL
## $ totalHours      &lt;dbl&gt; 75, 65, 39, NA, NA, 55, NA
## $ propTimeWorking &lt;dbl&gt; 0.6250000, 0.5416667, 0.3250000, NA, NA, 0.45833~</code></pre>
<p>Note that whenever one of our variables was unavailable, both of our new columns gave an <code>NA</code> value as well.</p>
<p>Suppose now that we wanted the same information, but we wanted to exclude all rows with <code>NA</code> values, and we only wanted to see our new columns and the respondent’s degree. This is a perfect situation for <code>transmute(...)</code>.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="wrangling-data.html#cb270-1" aria-hidden="true" tabindex="-1"></a>new_gss <span class="ot">&lt;-</span> gss2010 <span class="sc">%&gt;%</span></span>
<span id="cb270-2"><a href="wrangling-data.html#cb270-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">degree =</span> degree, <span class="co">#keeps the degree column</span></span>
<span id="cb270-3"><a href="wrangling-data.html#cb270-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">totalHours =</span> <span class="dv">5</span><span class="sc">*</span>hrsrelax <span class="sc">+</span> hrs1, <span class="co">#hours spent working and relaxing</span></span>
<span id="cb270-4"><a href="wrangling-data.html#cb270-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">propTimeWorking =</span> totalHours<span class="sc">/</span>(<span class="dv">5</span><span class="sc">*</span><span class="dv">24</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-5"><a href="wrangling-data.html#cb270-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="co">#drops all rows with an NA</span></span>
<span id="cb270-6"><a href="wrangling-data.html#cb270-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-7"><a href="wrangling-data.html#cb270-7" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_sample</span>(new_gss, <span class="at">n =</span> <span class="dv">7</span>)</span></code></pre></div>
<pre><code>## # A tibble: 7 x 3
##   degree         totalHours propTimeWorking
##   &lt;fct&gt;               &lt;dbl&gt;           &lt;dbl&gt;
## 1 GRADUATE               70           0.583
## 2 LT HIGH SCHOOL         54           0.45 
## 3 HIGH SCHOOL            52           0.433
## 4 BACHELOR               55           0.458
## 5 BACHELOR               65           0.542
## 6 BACHELOR               70           0.583
## 7 GRADUATE               50           0.417</code></pre>
<p>Next up, let’s start making some summary tables. First, let’s see if there’s a correlation between educational attainment and hours worked, hours relaxing, or days with mental health struggles. To do this, we want to group our dataset by the <code>degree</code> variable so that all of our summary functions are applied to the groups of respondents with the same degrees.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="wrangling-data.html#cb272-1" aria-hidden="true" tabindex="-1"></a>gss2010 <span class="sc">%&gt;%</span> </span>
<span id="cb272-2"><a href="wrangling-data.html#cb272-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(degree) <span class="sc">%&gt;%</span> </span>
<span id="cb272-3"><a href="wrangling-data.html#cb272-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>( <span class="at">meanHrsWrk =</span> <span class="fu">mean</span>(hrs1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),  <span class="co"># avg hours worked, removing NA</span></span>
<span id="cb272-4"><a href="wrangling-data.html#cb272-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">sdHrsWrk =</span> <span class="fu">sd</span>(hrs1, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># sd of hours worked, removing NA</span></span>
<span id="cb272-5"><a href="wrangling-data.html#cb272-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">meanHrsRlx =</span> <span class="fu">mean</span>(hrsrelax, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb272-6"><a href="wrangling-data.html#cb272-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">meanMntlHlth =</span> <span class="fu">mean</span>(mntlhlth, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb272-7"><a href="wrangling-data.html#cb272-7" aria-hidden="true" tabindex="-1"></a>             ) <span class="sc">%&gt;%</span></span>
<span id="cb272-8"><a href="wrangling-data.html#cb272-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(meanHrsWrk)) <span class="co"># arrange results in descending order</span></span></code></pre></div>
<pre><code>## # A tibble: 5 x 5
##   degree         meanHrsWrk sdHrsWrk meanHrsRlx meanMntlHlth
##   &lt;fct&gt;               &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;
## 1 BACHELOR             42.5     13.6       3.48         2.67
## 2 JUNIOR COLLEGE       41.4     18.1       3.53         3.56
## 3 GRADUATE             40.8     15.5       3.67         2.40
## 4 HIGH SCHOOL          39.6     15.0       3.79         4.58
## 5 LT HIGH SCHOOL       38.7     15.8       3.73         4.87</code></pre>
<p>So everyone works fairly similarly and relax a similar number of hours every night, but we observe that the number of days per month with mental health struggles seems to <em>decrease</em> with an increase in educational attainment.</p>
<p>We could also see if there’s any sort of relationship between degree and stance on marijuana legalization. First, let’s throw out all the rows with an <code>NA</code> for the <code>grass</code> variable and see how many people have type of degree.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="wrangling-data.html#cb274-1" aria-hidden="true" tabindex="-1"></a>gss2010 <span class="sc">%&gt;%</span></span>
<span id="cb274-2"><a href="wrangling-data.html#cb274-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( <span class="sc">!</span><span class="fu">is.na</span>(grass) ) <span class="sc">%&gt;%</span> <span class="co">#selects all rows where grass is *not* NA</span></span>
<span id="cb274-3"><a href="wrangling-data.html#cb274-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(degree) <span class="sc">%&gt;%</span></span>
<span id="cb274-4"><a href="wrangling-data.html#cb274-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>( <span class="at">degCount =</span> <span class="fu">n</span>(), <span class="co"># special function to count the number in each group</span></span>
<span id="cb274-5"><a href="wrangling-data.html#cb274-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">legalCount =</span> <span class="fu">sum</span>(grass <span class="sc">==</span> <span class="st">&quot;LEGAL&quot;</span> ),</span>
<span id="cb274-6"><a href="wrangling-data.html#cb274-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">legalProp =</span> legalCount <span class="sc">/</span> degCount</span>
<span id="cb274-7"><a href="wrangling-data.html#cb274-7" aria-hidden="true" tabindex="-1"></a>             )  <span class="sc">%&gt;%</span></span>
<span id="cb274-8"><a href="wrangling-data.html#cb274-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(legalProp))</span></code></pre></div>
<pre><code>## # A tibble: 5 x 4
##   degree         degCount legalCount legalProp
##   &lt;fct&gt;             &lt;int&gt;      &lt;int&gt;     &lt;dbl&gt;
## 1 GRADUATE            136         73     0.537
## 2 BACHELOR            231        119     0.515
## 3 HIGH SCHOOL         611        304     0.498
## 4 JUNIOR COLLEGE       86         42     0.488
## 5 LT HIGH SCHOOL      195         65     0.333</code></pre>
<p>So, roughly speaking, the percentage of people who believe marijuana should be legalized <em>increases</em> with educational attainment. This is likely not too surprising, but interesting to see shake out in the summary table none the less!</p>
<p>As usual, one can (and should!), do quite a bit more with these functions, but these examples should give you a reasonable idea about how they work and what they can do for you.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cross.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="distribution-calculations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/03-manipulting_data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
