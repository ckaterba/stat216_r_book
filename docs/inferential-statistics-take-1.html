<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Inferential statistics: Take 1 | R and RStudio for STAT216</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Inferential statistics: Take 1 | R and RStudio for STAT216" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Inferential statistics: Take 1 | R and RStudio for STAT216" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Charles Katerba" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="distribution-calculations.html"/>
<link rel="next" href="inferential-statistics-take-2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for STAT216 @ FVCC</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#organization"><i class="fa fa-check"></i><b>1.1</b> Organization</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#getting-started"><i class="fa fa-check"></i><b>1.2</b> Getting started</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#code-in-this-book"><i class="fa fa-check"></i><b>1.3</b> Code in this book</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#help"><i class="fa fa-check"></i><b>1.4</b> Help</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#debugging"><i class="fa fa-check"></i><b>1.5</b> Debugging</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#other-resources"><i class="fa fa-check"></i><b>1.6</b> Other resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rstudio-basics.html"><a href="rstudio-basics.html"><i class="fa fa-check"></i><b>2</b> RStudio basics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rstudio-basics.html"><a href="rstudio-basics.html#a-big-calculator"><i class="fa fa-check"></i><b>2.1</b> A big calculator</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="rstudio-basics.html"><a href="rstudio-basics.html#numbers"><i class="fa fa-check"></i><b>2.1.1</b> Numbers</a></li>
<li class="chapter" data-level="2.1.2" data-path="rstudio-basics.html"><a href="rstudio-basics.html#strings"><i class="fa fa-check"></i><b>2.1.2</b> Strings</a></li>
<li class="chapter" data-level="2.1.3" data-path="rstudio-basics.html"><a href="rstudio-basics.html#logicals-and-logical-operators"><i class="fa fa-check"></i><b>2.1.3</b> Logicals and Logical operators</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="rstudio-basics.html"><a href="rstudio-basics.html#naming-things"><i class="fa fa-check"></i><b>2.2</b> Naming things</a></li>
<li class="chapter" data-level="2.3" data-path="rstudio-basics.html"><a href="rstudio-basics.html#lists-and-vectors"><i class="fa fa-check"></i><b>2.3</b> Lists and vectors</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="rstudio-basics.html"><a href="rstudio-basics.html#creating-lists"><i class="fa fa-check"></i><b>2.3.1</b> Creating lists</a></li>
<li class="chapter" data-level="2.3.2" data-path="rstudio-basics.html"><a href="rstudio-basics.html#subsetting-lists"><i class="fa fa-check"></i><b>2.3.2</b> Subsetting lists</a></li>
<li class="chapter" data-level="2.3.3" data-path="rstudio-basics.html"><a href="rstudio-basics.html#special-lists"><i class="fa fa-check"></i><b>2.3.3</b> Special lists</a></li>
<li class="chapter" data-level="2.3.4" data-path="rstudio-basics.html"><a href="rstudio-basics.html#list-arithmetic"><i class="fa fa-check"></i><b>2.3.4</b> List arithmetic</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="rstudio-basics.html"><a href="rstudio-basics.html#packages"><i class="fa fa-check"></i><b>2.4</b> Packages</a></li>
<li class="chapter" data-level="2.5" data-path="rstudio-basics.html"><a href="rstudio-basics.html#data-frames-and-tibbles"><i class="fa fa-check"></i><b>2.5</b> Data frames and tibbles</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="rstudio-basics.html"><a href="rstudio-basics.html#creating-data-frames"><i class="fa fa-check"></i><b>2.5.1</b> Creating data frames</a></li>
<li class="chapter" data-level="2.5.2" data-path="rstudio-basics.html"><a href="rstudio-basics.html#using-data-frames"><i class="fa fa-check"></i><b>2.5.2</b> Using data frames</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="rstudio-basics.html"><a href="rstudio-basics.html#r-markdown-documents"><i class="fa fa-check"></i><b>2.6</b> R Markdown documents</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cross.html"><a href="cross.html"><i class="fa fa-check"></i><b>3</b> Summary statistics and data visualization</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cross.html"><a href="cross.html#summary-statistics-in-r"><i class="fa fa-check"></i><b>3.1</b> Summary statistics in R</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="cross.html"><a href="cross.html#numerical-variables"><i class="fa fa-check"></i><b>3.1.1</b> Numerical variables</a></li>
<li class="chapter" data-level="3.1.2" data-path="cross.html"><a href="cross.html#categorical-variables"><i class="fa fa-check"></i><b>3.1.2</b> Categorical variables</a></li>
<li class="chapter" data-level="3.1.3" data-path="cross.html"><a href="cross.html#combining-it-all"><i class="fa fa-check"></i><b>3.1.3</b> Combining it all</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="cross.html"><a href="cross.html#data-visualization"><i class="fa fa-check"></i><b>3.2</b> Data visualization</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="cross.html"><a href="cross.html#base-r"><i class="fa fa-check"></i><b>3.2.1</b> Base R</a></li>
<li class="chapter" data-level="3.2.2" data-path="cross.html"><a href="cross.html#ggplot2"><i class="fa fa-check"></i><b>3.2.2</b> <code>ggplot2</code></a></li>
<li class="chapter" data-level="3.2.3" data-path="cross.html"><a href="cross.html#saving-plots"><i class="fa fa-check"></i><b>3.2.3</b> Saving plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="wrangling-data.html"><a href="wrangling-data.html"><i class="fa fa-check"></i><b>4</b> Wrangling data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="wrangling-data.html"><a href="wrangling-data.html#the-goal-tidy-data."><i class="fa fa-check"></i><b>4.1</b> The goal: “tidy” data.</a></li>
<li class="chapter" data-level="4.2" data-path="wrangling-data.html"><a href="wrangling-data.html#the-pipe"><i class="fa fa-check"></i><b>4.2</b> The pipe</a></li>
<li class="chapter" data-level="4.3" data-path="wrangling-data.html"><a href="wrangling-data.html#common-tidying-operations"><i class="fa fa-check"></i><b>4.3</b> Common tidying operations</a></li>
<li class="chapter" data-level="4.4" data-path="wrangling-data.html"><a href="wrangling-data.html#mutate-group-by-and-summarize"><i class="fa fa-check"></i><b>4.4</b> Mutate, group by, and summarize</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="distribution-calculations.html"><a href="distribution-calculations.html"><i class="fa fa-check"></i><b>5</b> Distribution calculations</a>
<ul>
<li class="chapter" data-level="5.1" data-path="distribution-calculations.html"><a href="distribution-calculations.html#finite-discrete-distribution-calculations"><i class="fa fa-check"></i><b>5.1</b> Finite discrete distribution calculations</a></li>
<li class="chapter" data-level="5.2" data-path="distribution-calculations.html"><a href="distribution-calculations.html#named-distribution-calculations"><i class="fa fa-check"></i><b>5.2</b> Named distribution calculations</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="distribution-calculations.html"><a href="distribution-calculations.html#discrete-random-variables"><i class="fa fa-check"></i><b>5.2.1</b> Discrete random variables</a></li>
<li class="chapter" data-level="5.2.2" data-path="distribution-calculations.html"><a href="distribution-calculations.html#continuous-random-variables"><i class="fa fa-check"></i><b>5.2.2</b> Continuous random variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html"><i class="fa fa-check"></i><b>6</b> Inferential statistics: Take 1</a>
<ul>
<li class="chapter" data-level="6.1" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#basics-of-statistical-inference"><i class="fa fa-check"></i><b>6.1</b> Basics of statistical inference</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#sampling-distributions"><i class="fa fa-check"></i><b>6.1.1</b> Sampling distributions</a></li>
<li class="chapter" data-level="6.1.2" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#confidence-intervals"><i class="fa fa-check"></i><b>6.1.2</b> Confidence intervals</a></li>
<li class="chapter" data-level="6.1.3" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#hypothesis-tests"><i class="fa fa-check"></i><b>6.1.3</b> Hypothesis tests</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#analyzing-categorical-variables"><i class="fa fa-check"></i><b>6.2</b> Analyzing categorical variables</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#single-sample-proportion"><i class="fa fa-check"></i><b>6.2.1</b> Single sample proportion</a></li>
<li class="chapter" data-level="6.2.2" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#two-sample-proportion"><i class="fa fa-check"></i><b>6.2.2</b> Two sample proportion</a></li>
<li class="chapter" data-level="6.2.3" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#chi-squared-tests"><i class="fa fa-check"></i><b>6.2.3</b> Chi-squared tests</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#analyzing-numerical-variables"><i class="fa fa-check"></i><b>6.3</b> Analyzing numerical variables</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#single-sample-mean"><i class="fa fa-check"></i><b>6.3.1</b> Single sample mean</a></li>
<li class="chapter" data-level="6.3.2" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#two-sample-mean"><i class="fa fa-check"></i><b>6.3.2</b> Two sample mean</a></li>
<li class="chapter" data-level="6.3.3" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#paired-data"><i class="fa fa-check"></i><b>6.3.3</b> Paired data</a></li>
<li class="chapter" data-level="6.3.4" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#analysis-of-variance-anova"><i class="fa fa-check"></i><b>6.3.4</b> Analysis of variance (ANOVA)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html"><i class="fa fa-check"></i><b>7</b> Inferential statistics, take 2</a>
<ul>
<li class="chapter" data-level="7.1" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#analyzing-categorical-variables-1"><i class="fa fa-check"></i><b>7.1</b> Analyzing categorical variables</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#single-sample-proportions"><i class="fa fa-check"></i><b>7.1.1</b> Single sample proportions</a></li>
<li class="chapter" data-level="7.1.2" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#two-sample-proportions"><i class="fa fa-check"></i><b>7.1.2</b> Two sample proportions</a></li>
<li class="chapter" data-level="7.1.3" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#chi-squared-goodness-of-fit-test"><i class="fa fa-check"></i><b>7.1.3</b> Chi-squared goodness of fit test</a></li>
<li class="chapter" data-level="7.1.4" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#chi-squared-test-of-independence-1"><i class="fa fa-check"></i><b>7.1.4</b> Chi-squared test of independence</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#analyzing-numerical-variables-1"><i class="fa fa-check"></i><b>7.2</b> Analyzing numerical variables</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#single-sample-mean-1"><i class="fa fa-check"></i><b>7.2.1</b> Single sample mean</a></li>
<li class="chapter" data-level="7.2.2" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#two-sample-mean-1"><i class="fa fa-check"></i><b>7.2.2</b> Two sample mean</a></li>
<li class="chapter" data-level="7.2.3" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#paired-data-1"><i class="fa fa-check"></i><b>7.2.3</b> Paired data</a></li>
<li class="chapter" data-level="7.2.4" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#analysis-of-variance-anova-1"><i class="fa fa-check"></i><b>7.2.4</b> Analysis of variance (ANOVA)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modeling-relationships.html"><a href="modeling-relationships.html"><i class="fa fa-check"></i><b>8</b> Modeling relationships</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modeling-relationships.html"><a href="modeling-relationships.html#simple-linear-regression"><i class="fa fa-check"></i><b>8.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="8.2" data-path="modeling-relationships.html"><a href="modeling-relationships.html#multiple-linear-regression"><i class="fa fa-check"></i><b>8.2</b> Multiple linear regression</a></li>
<li class="chapter" data-level="8.3" data-path="modeling-relationships.html"><a href="modeling-relationships.html#bonus-topic-logistic-regression"><i class="fa fa-check"></i><b>8.3</b> Bonus topic: logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R and RStudio for STAT216</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inferential-statistics-take-1" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Inferential statistics: Take 1<a href="inferential-statistics-take-1.html#inferential-statistics-take-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter and the next are going to introduce inferential statistics in R, but from two different perspectives. This chapter will focus on doing all of the calculations involved in statistical inference “by hand” (where here we really mean using R to implement the formulas/ideas). The next chapter will show you how to perform many of the same calculations using functions native to R. It is valuable knowing how to do both so that you can check one or the other or possibly write your own type of statistical test one day!</p>
<p>Both chapters will be organized according to the type of variables we will be analyzing. So, for example, we’ll start with statistical inference for a single categorical variable. One can (and probably should) read the “by hand” section of this chapter in tandem with the corresponding native function section of the next chapter. This chapter will include a brief summary of the ideas involved in statistical inference, but the next will just go straight into the details.</p>
<p>The code chunk below attaches all packages we’ll use in this chapter and sets a <em>seed</em> which basically determines a starting point for some of the randomization we’ll employ in the chapter. Setting a seed insures that the same random samples will be drawn every time the code is run.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="inferential-statistics-take-1.html#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb329-2"><a href="inferential-statistics-take-1.html#cb329-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openintro)</span>
<span id="cb329-3"><a href="inferential-statistics-take-1.html#cb329-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(infer)</span>
<span id="cb329-4"><a href="inferential-statistics-take-1.html#cb329-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1187</span>)</span></code></pre></div>
<div id="basics-of-statistical-inference" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Basics of statistical inference<a href="inferential-statistics-take-1.html#basics-of-statistical-inference" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will learn about three primary types of statistical inference in this class, each aimed at answering different types of questions. To illustrate the types of questions we endeavor to answer, think about analyzing the political landscape in America. You could ask:</p>
<ol style="list-style-type: decimal">
<li><p>What proportion of Americans identify as politically independent?</p></li>
<li><p>Are there more politically independent people in Montana than in Idaho?</p></li>
<li><p>How what proportion of voters will identify as politically independent in the future?</p></li>
</ol>
<p>The first question is asking for an estimate of a population parameter (the true proportion of independents in America). The second question, on the other hand, is asking about a difference between two population parameters. The third requires a prediction based on past data. These types of questions are certainly related (for instance, you could answer the second question by estimating each of the two population parameters), but the most common tools for answering them are slightly different.</p>
<p>Our main tool for answering the first question above is a <strong>confidence interval</strong>, which uses an estimate of the amount of variable we expect between <em>samples</em> to provided a range of plausible values for the population parameter. The tool we use to answer the second question is called a <strong>hypothesis test</strong>; these test assess how likely or unlikely your <em>sample</em> is if there were no differences. Hypothesis tests involve understanding the amount of variability we expect to see between samples. We access this this quantity by understanding the distribution of possible samples. The probability distribution associated to all possible samples is called a <strong>sampling distribution</strong>, which we discuss more in the next section.</p>
<div id="sampling-distributions" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Sampling distributions<a href="inferential-statistics-take-1.html#sampling-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Taking a simple random sample is, of course, a random process. Assigning a number like the sample proportion or sample average to this sample, then, naturally turns sample statistics into random variables. Since we can think of each sample statistic as a random variable, each sample statistic has an associated probability distribution called a <strong>sampling distribution</strong>! The overall population under consideration determines the sampling distribution and we almost never have access to population-level data, so you may wonder how or if we have any hope of understanding the sampling distribution of our statistic of interest. In particular, we hope to understand the shape, the center, and the spread of the sampling distribution. There are two primary was of doing this: through simulation and through theory. This class touches briefly on the simulation approach, but focuses mostly on the theoretical approach to accessing sampling distributions.</p>
<p>Before moving on to describe these approaches, we need a quick definition that helps us differentiate from talking about a population distribution and talking about a sampling distribution. The <strong>standard error</strong>, abbreviated SE, of a sampling distribution is simply its standard deviation.</p>
<p>One of the miracles of statistics (Note: it is not a <em>real</em> miracle since it is a mathematical theorem, but it amazes the author to this day.) is the <strong>Central Limit Theorem</strong>. We will state the Central Limit Theorem in a few different ways throughout this chapter, but each version essentially says the same thing. Namely, if you have a sufficiently large (caution: this means different things in different contexts) and high quality sample (IE a sample with independent observations, usually obtained through random sampling), the sampling distribution will be symmetric and unimodal with its center at the true population parameter. Moreover, as the sample size increases, the standard error decreases. In other words, all sample statistics will cluster around the true population parameter and observing a sample stat above the population parameter is just as likely as observing one below. The fact that the standard error decreases as the sample size increases codifies our intuition that “large samples are usually better,” since it implies that a sample statistic calculated from a larger sample is more likely to be close to the true population parameter than one calculated from a smaller sample.</p>
<p>Before moving on to discuss how we use sampling distributions, let’s try to make this a bit more concrete by simulating a sampling distribution using a technique called <a href="https://en.wikipedia.org/wiki/Bootstrapping_(statistics)"><strong>bootstrapping</strong></a> which takes a large, random sample, and resamples it many times <em>with replacement</em> to simulate the process of taking many different samples. We’ll use the <code>gss2010</code> data set from the <code>openintro</code> package which records the highest educational attainment (among other things) of 2044 randomly sampled Americans in 2010.</p>
<p>Suppose we’re interested in knowing more about the proportion of all Americans who do not have a high school diploma. The <code>gss2010</code> data set serves as our sample and we can use the sample proportion <span class="math inline">\(\hat{p}\)</span>, read as “p hat”, as a <strong>point estimate</strong> for the true population proportion <span class="math inline">\(p\)</span>.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="inferential-statistics-take-1.html#cb330-1" aria-hidden="true" tabindex="-1"></a>pHat <span class="ot">&lt;-</span> <span class="fu">sum</span>(gss2010<span class="sc">$</span>degree <span class="sc">==</span> <span class="st">&quot;LT HIGH SCHOOL&quot;</span>) <span class="sc">/</span> <span class="fu">length</span>(gss2010<span class="sc">$</span>degree)</span>
<span id="cb330-2"><a href="inferential-statistics-take-1.html#cb330-2" aria-hidden="true" tabindex="-1"></a>pHat</span></code></pre></div>
<pre><code>## [1] 0.1492172</code></pre>
<p>So our sample indicates that in 2010, about 15% of the American population had less than a high school diploma. But this is only a sample of 2044 Americans. If we took another sample of 2044 people and calculated the same proportion, how different do we expect that proportion to be? We can simulate this by drawing from our original sample, but doing so <em>with replacement</em>.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="inferential-statistics-take-1.html#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Take sample </span></span>
<span id="cb332-2"><a href="inferential-statistics-take-1.html#cb332-2" aria-hidden="true" tabindex="-1"></a>sample2 <span class="ot">&lt;-</span> <span class="fu">sample</span>( gss2010<span class="sc">$</span>degree, <span class="at">size =</span> <span class="dv">2044</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb332-3"><a href="inferential-statistics-take-1.html#cb332-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Find proportion of high school dropouts</span></span>
<span id="cb332-4"><a href="inferential-statistics-take-1.html#cb332-4" aria-hidden="true" tabindex="-1"></a>pHat2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(sample2 <span class="sc">==</span> <span class="st">&quot;LT HIGH SCHOOL&quot;</span>) <span class="sc">/</span> <span class="fu">length</span>(sample2)</span>
<span id="cb332-5"><a href="inferential-statistics-take-1.html#cb332-5" aria-hidden="true" tabindex="-1"></a>pHat2</span></code></pre></div>
<pre><code>## [1] 0.1364971</code></pre>
<p>This sample proportion is different, but not by too much. Of course, 2 different samples don’t provide enough evidence to make any conclusions about the amount of variability we should expect among <em>all</em> possible samples. To estimate the standard error, we need to simulate many more samples. We’ll use the following code, using commands from the <code>infer</code> package, to do this. The code below takes 5000 samples of size 2044 from our original sample again with replacement, changes the degree column in each sample to a binary outcome (no HS diploma, or other), counts the number of people in each sample without a high school diploma, then calculates the corresponding sample proportion.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="inferential-statistics-take-1.html#cb334-1" aria-hidden="true" tabindex="-1"></a>simulated_sampling_distr <span class="ot">&lt;-</span> gss2010 <span class="sc">%&gt;%</span></span>
<span id="cb334-2"><a href="inferential-statistics-take-1.html#cb334-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep_sample_n</span>(<span class="at">size =</span> <span class="dv">2044</span>, <span class="at">reps =</span> <span class="dv">5000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb334-3"><a href="inferential-statistics-take-1.html#cb334-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">degree =</span> <span class="fu">if_else</span>(degree <span class="sc">==</span> <span class="st">&quot;LT HIGH SCHOOL&quot;</span>, <span class="st">&quot;LT HIGH SCHOOL&quot;</span>, <span class="st">&quot;other&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb334-4"><a href="inferential-statistics-take-1.html#cb334-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(degree) <span class="sc">%&gt;%</span></span>
<span id="cb334-5"><a href="inferential-statistics-take-1.html#cb334-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_hat =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb334-6"><a href="inferential-statistics-take-1.html#cb334-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( degree <span class="sc">==</span> <span class="st">&quot;LT HIGH SCHOOL&quot;</span>)</span>
<span id="cb334-7"><a href="inferential-statistics-take-1.html#cb334-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb334-8"><a href="inferential-statistics-take-1.html#cb334-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(simulated_sampling_distr)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
## # Groups:   replicate [6]
##   replicate degree             n p_hat
##       &lt;int&gt; &lt;chr&gt;          &lt;int&gt; &lt;dbl&gt;
## 1         1 LT HIGH SCHOOL   322 0.158
## 2         2 LT HIGH SCHOOL   315 0.154
## 3         3 LT HIGH SCHOOL   317 0.155
## 4         4 LT HIGH SCHOOL   310 0.152
## 5         5 LT HIGH SCHOOL   314 0.154
## 6         6 LT HIGH SCHOOL   311 0.152</code></pre>
<p>We’ve simulated a sampling distribution! Let’s look at a histogram of this simulated distribution to assess it’s shape and spread. Remember, the Central Limit Theorem says this distribution should likely by symmetric and unimodal.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="inferential-statistics-take-1.html#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(simulated_sampling_distr, <span class="fu">aes</span>(<span class="at">x =</span> p_hat)) <span class="sc">+</span> </span>
<span id="cb336-2"><a href="inferential-statistics-take-1.html#cb336-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb336-3"><a href="inferential-statistics-take-1.html#cb336-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of sample proportions, n = 2044&quot;</span>, </span>
<span id="cb336-4"><a href="inferential-statistics-take-1.html#cb336-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Estimating SE for 2010 proportion of Americans without a HS diploma&quot;</span>,</span>
<span id="cb336-5"><a href="inferential-statistics-take-1.html#cb336-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Sample proportion, p-hat&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-190-1.png" width="672" /></p>
<p>Voila! Our sampling distribution does seem to be symmetric and unimodal. Where precisely is the center?</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="inferential-statistics-take-1.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="co">#average sample proportion</span></span>
<span id="cb337-2"><a href="inferential-statistics-take-1.html#cb337-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(simulated_sampling_distr<span class="sc">$</span>p_hat)</span></code></pre></div>
<pre><code>## [1] 0.1492041</code></pre>
<p>What, approximately, is the <strong>standard error</strong>? Simply the standard deviation of the column <code>p_hat</code>!</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="inferential-statistics-take-1.html#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(simulated_sampling_distr<span class="sc">$</span>p_hat)</span></code></pre></div>
<pre><code>## [1] 0.007862322</code></pre>
<p>This means if we were to repeatedly sample 2044 Americans and record the proportion of people with less than a college degree, we should expect to see a difference of about 0.8% between the proportions on average. As will see in the next two sections, <strong>understanding the standard error is the key to performing inferential statistics</strong>. However, before we move on to using sampling distributions, let’s simulate the Central Limit Theorem’s other main claim: the standard error decreases as the sample size increases.</p>
<p>To show this, we’ll go the opposite direction and take smaller samples from the <code>gss2010</code> data set. We should see the standard error of this simulated distribution <em>increase</em>. The code below simulates a sampling distribution with sample size <span class="math inline">\(n = 100\)</span>.</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="inferential-statistics-take-1.html#cb341-1" aria-hidden="true" tabindex="-1"></a>sampling_dist2 <span class="ot">&lt;-</span> gss2010 <span class="sc">%&gt;%</span></span>
<span id="cb341-2"><a href="inferential-statistics-take-1.html#cb341-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep_sample_n</span>(<span class="at">size =</span> <span class="dv">100</span>, <span class="at">reps =</span> <span class="dv">5000</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb341-3"><a href="inferential-statistics-take-1.html#cb341-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">degree =</span> <span class="fu">if_else</span>(degree <span class="sc">==</span> <span class="st">&quot;LT HIGH SCHOOL&quot;</span>, <span class="st">&quot;LT HIGH SCHOOL&quot;</span>, <span class="st">&quot;other&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb341-4"><a href="inferential-statistics-take-1.html#cb341-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(degree) <span class="sc">%&gt;%</span></span>
<span id="cb341-5"><a href="inferential-statistics-take-1.html#cb341-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_hat =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb341-6"><a href="inferential-statistics-take-1.html#cb341-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( degree <span class="sc">==</span> <span class="st">&quot;LT HIGH SCHOOL&quot;</span>)</span>
<span id="cb341-7"><a href="inferential-statistics-take-1.html#cb341-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-8"><a href="inferential-statistics-take-1.html#cb341-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sampling_dist2)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
## # Groups:   replicate [6]
##   replicate degree             n p_hat
##       &lt;int&gt; &lt;chr&gt;          &lt;int&gt; &lt;dbl&gt;
## 1         1 LT HIGH SCHOOL     8  0.08
## 2         2 LT HIGH SCHOOL    20  0.2 
## 3         3 LT HIGH SCHOOL    21  0.21
## 4         4 LT HIGH SCHOOL    15  0.15
## 5         5 LT HIGH SCHOOL    15  0.15
## 6         6 LT HIGH SCHOOL    20  0.2</code></pre>
<p>Note that just looking at the first 6 sample proportions we can already see more variability than our first distribution. Let’s visualize this one.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="inferential-statistics-take-1.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sampling_dist2, <span class="fu">aes</span>(<span class="at">x =</span> p_hat)) <span class="sc">+</span> </span>
<span id="cb343-2"><a href="inferential-statistics-take-1.html#cb343-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb343-3"><a href="inferential-statistics-take-1.html#cb343-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Distribution of sample proportions, n = 100&quot;</span>, </span>
<span id="cb343-4"><a href="inferential-statistics-take-1.html#cb343-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Estimating SE for 2010 proportion of Americans without a HS diploma&quot;</span>,</span>
<span id="cb343-5"><a href="inferential-statistics-take-1.html#cb343-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Sample proportion, p-hat&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-194-1.png" width="672" /></p>
<p>Notice that the center is about the same as our first sampling distribution, but our second is more spread out as we claimed above! To check these claims, let’s look at the average sample proportion and the estimated standard error.</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="inferential-statistics-take-1.html#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(sampling_dist2<span class="sc">$</span>p_hat)</span></code></pre></div>
<pre><code>## [1] 0.14884</code></pre>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="inferential-statistics-take-1.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(sampling_dist2<span class="sc">$</span>p_hat)</span></code></pre></div>
<pre><code>## [1] 0.0353421</code></pre>
<p>The average sample proportions are super close, but the standard error of our distribution with <span class="math inline">\(n = 100\)</span> is about 5 times as large as the standard error of the distribution with <span class="math inline">\(n = 2044\)</span>. This fits our intuition: small samples are less reliable because they have more variability around the population parameter.</p>
<p>Now that we have a feel for sampling distributions, let’s use these simulated sampling distributions to make some inferences.</p>
</div>
<div id="confidence-intervals" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Confidence intervals<a href="inferential-statistics-take-1.html#confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall that a <strong>confidence interval</strong> provides a range of plausible values for a population parameter. For example, we will use our point estimates from the previous section to estimate the true proportion of Americans without a high school diploma. The width of a confidence level depends on two quantities:</p>
<ul>
<li><p>the <strong>confidence level</strong>: a measure of the likelihood that our interval contains to true population parameter. Typical confidence levels are 90%, 95%, and 99%.</p></li>
<li><p>the <strong>standard error</strong>: the standard deviation of the sampling distribution.</p></li>
</ul>
<p>Your confidence level determines a <em>critical value</em> <span class="math inline">\(CV\)</span>. If your confidence level is <span class="math inline">\(CL\)</span>, then <span class="math inline">\(CL\)</span>% of all sample proportions will fall within <span class="math inline">\(CV\)</span> standard deviations of the true population parameter within the sampling distribution. Thus, as your confidence level increase, the critical value increases, and so your confidence interval ends up getting wider. This makes sense: to be more confident in your estimate, your range of plausible values better be “larger.”</p>
<p>Now we can describe the general formula for confidence intervals:</p>
<p><span class="math display">\[ \text{point estimate} \pm CV \cdot SE\]</span></p>
<p>In the sections to come, the details of your point estimates along with the procedure to calculate the standard error and critical value will change, but the general formula for a confidence interval is always the same. With this in mind, it becomes much more important to be able to correctly interpret confidence intervals. Before closing out this section, let’s use our simulated sampling distribution from the previous section to estimate the proportion of Americans without a high school diploma in 2010. In particular, we’ll calculate a 95% confidence interval.</p>
<p>Looking back at the histogram of <code>simulated_sampling_distr</code>, we see that it is approximately normally distributed. Recall that roughly 95% of all observations in a normal distribution fall within two standard deviations from the center. Thus, as a rough approximation, our critical value is <span class="math inline">\(CV = 2\)</span>.</p>
<p>We’ve also already found our point estimate, the sample proportion of Americans without a high school diploma <code>pHat</code>, and our standard error, the standard deviation of the sampling distribution.</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="inferential-statistics-take-1.html#cb348-1" aria-hidden="true" tabindex="-1"></a>pHat</span></code></pre></div>
<pre><code>## [1] 0.1492172</code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="inferential-statistics-take-1.html#cb350-1" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sd</span>(simulated_sampling_distr<span class="sc">$</span>p_hat)</span>
<span id="cb350-2"><a href="inferential-statistics-take-1.html#cb350-2" aria-hidden="true" tabindex="-1"></a>SE</span></code></pre></div>
<pre><code>## [1] 0.007862322</code></pre>
<p>Using the formula, <span class="math inline">\(\text{point estimate} \pm CV \cdot SE\)</span>, our 95% confidence interval is</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="inferential-statistics-take-1.html#cb352-1" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> pHat <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>SE</span>
<span id="cb352-2"><a href="inferential-statistics-take-1.html#cb352-2" aria-hidden="true" tabindex="-1"></a>CI</span></code></pre></div>
<pre><code>## [1] 0.1334926 0.1649419</code></pre>
<p>In other words, with 95% confidence, we estimate that between 13.3% and 16.5% of all Americans in 2010 did not have a high school diploma.</p>
</div>
<div id="hypothesis-tests" class="section level3 hasAnchor" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> Hypothesis tests<a href="inferential-statistics-take-1.html#hypothesis-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We use confidence intervals to estimate population parameters, but sometimes we only want to figure out if a population parameter differs from some value. This situation arises when you ask questions like “Will a majority of American Republicans vote for Donald Trump in the 2024 presidential election primary?” or “Do more than 10% of Americans fail to graduate high school?” To answer these types of questions statistically, we perform <strong>hypothesis tests</strong>. Every hypothesis test has two competing claims:</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>, the null hypothesis. This typically represents the status quo, that there is no difference, that there is no effect, or that the variables independent.</p></li>
<li><p><span class="math inline">\(H_a\)</span>: the research or alternative hypothesis. This represents, well, your research question. There is a difference, or an effect, or the variables in question are dependent.</p></li>
</ul>
<p>We always express the null and alternative hypothesis as statements involving population parameters. For instance, if <span class="math inline">\(p\)</span> represents the proportion of Americans without a high school diploma in 2010, we would turn the question “Do more than 10% of Americans fail to graduate high school?” into a hypothesis test as</p>
<ul>
<li><p><span class="math inline">\(H_0 : p = .1\)</span> (or <span class="math inline">\(p \leq .1\)</span>)</p></li>
<li><p><span class="math inline">\(H_a : p &gt; .1\)</span></p></li>
</ul>
<p>We use sample data to evaluate hypothesis tests and do so by determining how likely or unlikely our sample data would be <em>if the null hypothesis were true</em>. This is called the <span class="math inline">\(p\)</span>-value of a sample. More precisely, the <strong><span class="math inline">\(p\)</span>-value</strong> of a sample is the probability of observing a sample at least as a favorable for the alternative hypothesis as your own, assuming the null hypothesis is true.</p>
<p>Let’s think about what a <span class="math inline">\(p\)</span>-value tells is. If you have a relatively small <span class="math inline">\(p\)</span>-value, say .01, then there would be a 1% chance of observing the data you have (or data that’s even more extreme) if the null were true. We have two competing possibilities here: either the null hypothesis is true and we have witnessed a rare event simply by chance or the alternative hypothesis is true. Unfortunately (and this is especially if you only have a single sample) there’s no way to tell which world you’re living in! As an attempt to remedy this dilemma, we must set a <strong>significance level</strong> <em>before</em> performing our hypothesis test. The most common significance levels are <span class="math inline">\(\alpha = .01, .05, \text{ and } .1\)</span>. You use the significance level <span class="math inline">\(\alpha\)</span> to evaluate the hypothesis test. In particular, if</p>
<ul>
<li><p>the <span class="math inline">\(p\)</span>-value is less than <span class="math inline">\(\alpha\)</span>, reject the null and accept the alternative. Or</p></li>
<li><p>the <span class="math inline">\(p\)</span>-value is greater than or equal to <span class="math inline">\(\alpha\)</span>, you fail to reject the null.</p></li>
</ul>
<p>Note that a hypothesis test is like a jury trial: a jury either finds the defendant guilty or not guilty, they never deem a defendant innocent. Similarly, we can never <em>prove</em> the null hypothesis; instead, we can only collect enough evidence to believe that it is false. With this in mind, we think of the <strong>significance level</strong> <span class="math inline">\(\alpha\)</span> as the probability of a false positive in a hypothesis test. In other words, if the null were true and you could repeatedly perform the same hypothesis test, you would end up rejecting the null <span class="math inline">\(\alpha\)</span>% of the time.</p>
<p>In general, there are three broad types of hypothesis tests: one-tailed upper, one-tailed lower, and two-tailed tests. The type of test determines how you calculate the <span class="math inline">\(p\)</span>-value of your sample because it determines what counts as “more favorable for the alternative hypothesis.”</p>
<p>To illustrate this idea, let’s pretend we’re performing a hypothesis test for a proportion with</p>
<p><span class="math display">\[ H_0:  p = .5 \]</span></p>
<p>and suppose we took a sample with size <span class="math inline">\(n = 200\)</span> and <span class="math inline">\(\hat{p} = .55\)</span>. Below we’ll look at the three types of alternative hypotheses and visualize the corresponding <span class="math inline">\(p\)</span>-values for our imaginary sample.</p>
<ol style="list-style-type: decimal">
<li><strong>Two-sided hypothesis test</strong>. In this case, we’re simply checking to see if the population parameter deviates from the null value. For our example:
<span class="math display">\[ H_a: p \neq .5  \]</span></li>
</ol>
<p>Samples that are at least as favorable for <span class="math inline">\(H_a\)</span> as our own come in two flavors: samples with a proportion of at least .55 and those with a proportion of <em>at most</em> .45. Notice that the samples with proportions of at most .45 really are just as favorable as those with proportions of at least .55 when we’re checking for a difference because they are equally as far away from the null proportion of .5. Thus, the <span class="math inline">\(p\)</span>-value of a two-sided hypothesis tests will be a two-tailed probability. The plot below helps visualize this <span class="math inline">\(p\)</span>-value as an area in the sampling distribution. We have hidden the plotting code here to prioritize the concepts.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-198-1.png" width="672" /></p>
<ol start="2" style="list-style-type: decimal">
<li><strong>One-sided upper hypothesis test</strong>: In this case, we’re simply checking to see if the population parameter is greater than the null value. For our example:</li>
</ol>
<p><span class="math display">\[ H_a: p &gt; .5  \]</span></p>
<p>Samples that are at least as favorable for <span class="math inline">\(H_a\)</span> as our own only one flavor this time: samples with a proportion of at least .55. Thus the <span class="math inline">\(p\)</span>-value for this hypothesis test is an upper-tail area. The plot below helps us visualize this.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-199-1.png" width="672" /></p>
<ol start="3" style="list-style-type: decimal">
<li><strong>One-sided lower hypothesis test</strong>: In this case, we’re simply checking to see if the population parameter is less than the null value. For our example:</li>
</ol>
<p><span class="math display">\[ H_a: p &gt; .5  \]</span></p>
<p>Samples that are at least as favorable for <span class="math inline">\(H_a\)</span> as our own only one flavor: samples with a proportion of at most .55. Thus the <span class="math inline">\(p\)</span>-value for this hypothesis test is a lower-tail area in the sampling distribution. The plot below helps us visualize this.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-200-1.png" width="672" /></p>
<p>Our <span class="math inline">\(p\)</span>-value is large because our sample proportion is above the null value when we thought it was going to be below. We should revise our alternative hypothesis in this case.</p>
<p>Let’s finish this section using the high school diploma question we started this chapter with. In particular, in 2010 did more than 10% of Americans fail to graduate high school? As a hypothesis test:</p>
<ul>
<li><p><span class="math inline">\(H_0: p = .1\)</span></p></li>
<li><p><span class="math inline">\(H_a: p &gt; .1\)</span></p></li>
</ul>
<p>Let’s set our significance level to <span class="math inline">\(\alpha .05\)</span>. To evaluate the hypothesis test need to calculate a <span class="math inline">\(p\)</span>-value. To accomplish this, we need to be able to assess the likelihood of our sample assuming the null hypothesis is true. Here we’re still using the <code>gss2010</code> data for our sample; recall the recall the sample proportion is <span class="math inline">\(\hat{p} \approx 0.149\)</span> and the sample size is <span class="math inline">\(n = 2044\)</span>.</p>
<p>In the next section we’ll learn some theory that describes the sampling distribution, but we will simulate a sampling distribution under the null hypothesis.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="inferential-statistics-take-1.html#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generates results from 5000 binomial experiments w/ probability of </span></span>
<span id="cb354-2"><a href="inferential-statistics-take-1.html#cb354-2" aria-hidden="true" tabindex="-1"></a><span class="co"># success = .1 and sample size of n = 2044, returns sample proportion. </span></span>
<span id="cb354-3"><a href="inferential-statistics-take-1.html#cb354-3" aria-hidden="true" tabindex="-1"></a>null_dist <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">p_hat =</span> <span class="fu">rbinom</span>(<span class="dv">5000</span>, <span class="dv">2044</span>, .<span class="dv">1</span>)<span class="sc">/</span><span class="dv">2044</span>)</span>
<span id="cb354-4"><a href="inferential-statistics-take-1.html#cb354-4" aria-hidden="true" tabindex="-1"></a><span class="co"># center of distribution</span></span>
<span id="cb354-5"><a href="inferential-statistics-take-1.html#cb354-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(null_dist<span class="sc">$</span>p_hat)</span></code></pre></div>
<pre><code>## [1] 0.1000021</code></pre>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="inferential-statistics-take-1.html#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="co"># standard error</span></span>
<span id="cb356-2"><a href="inferential-statistics-take-1.html#cb356-2" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sd</span>(null_dist<span class="sc">$</span>p_hat)</span>
<span id="cb356-3"><a href="inferential-statistics-take-1.html#cb356-3" aria-hidden="true" tabindex="-1"></a>SE</span></code></pre></div>
<pre><code>## [1] 0.006583714</code></pre>
<p>Let’s visualize the null distribution and our sample proportion <span class="math inline">\(\hat{p}\)</span>’s location in the nul distribution.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="inferential-statistics-take-1.html#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(null_dist, <span class="fu">aes</span>(<span class="at">x =</span> p_hat)) <span class="sc">+</span> </span>
<span id="cb358-2"><a href="inferential-statistics-take-1.html#cb358-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb358-3"><a href="inferential-statistics-take-1.html#cb358-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> pHat, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb358-4"><a href="inferential-statistics-take-1.html#cb358-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Null distribution with p = .1 and n = 2044, pHat = .149&quot;</span>, </span>
<span id="cb358-5"><a href="inferential-statistics-take-1.html#cb358-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Sample proportion, p-hat&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-202-1.png" width="672" /></p>
<p>As we’d expect the null sampling distribution is approximately normal. The plot above indicates that our sample proportion <span class="math inline">\(\hat{p}\)</span> would be quite unlikely if the null hypothesis were true. To estimate exactly how unlikely, let’s <em>estimate</em> the <span class="math inline">\(p\)</span>-value of our sample.</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="inferential-statistics-take-1.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count the number of simulated samples with proportions at least as large as </span></span>
<span id="cb359-2"><a href="inferential-statistics-take-1.html#cb359-2" aria-hidden="true" tabindex="-1"></a><span class="co"># our actual sample proportion, divide by number of samples in simulated dist.</span></span>
<span id="cb359-3"><a href="inferential-statistics-take-1.html#cb359-3" aria-hidden="true" tabindex="-1"></a>pValue <span class="ot">&lt;-</span> <span class="fu">sum</span>(null_dist<span class="sc">$</span>p_hat <span class="sc">&gt;=</span> pHat ) <span class="sc">/</span> <span class="fu">length</span>(null_dist<span class="sc">$</span>p_hat)</span>
<span id="cb359-4"><a href="inferential-statistics-take-1.html#cb359-4" aria-hidden="true" tabindex="-1"></a>pValue</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>This means that if 10% of Americans didn’t have high school diplomas in 2010, the probability of finding a sample of 2044 Americans of which 14.9% or more do not have a high school diploma is essentially 0.</p>
<p>Because our <span class="math inline">\(p\)</span>-value is less than the significance level <span class="math inline">\(\alpha = .05\)</span>, we reject the null hypothesis and accept the alternative. In other words, our data provide compelling evidence to believe that more than 10% of Americans in 2010 did not have a high school diploma.</p>
<p>We finish this section by noting that we spent a lot of time on this example and a lot of time/space on explanation here. Once you get the hang of this, you will perform and interpret hypothesis tests quickly and efficiently. Moreover, most of what we’ll do in this class will <em>not</em> require simulating sampling distributions. For more on this, read on!</p>
</div>
</div>
<div id="analyzing-categorical-variables" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Analyzing categorical variables<a href="inferential-statistics-take-1.html#analyzing-categorical-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now we will move in to using theoretical sampling distributions to calculate confidence intervals and perform hypothesis tests. The key almost all of the theoretical sampling distributions is the <strong>central limit theorem</strong>, which states that, if you have a large enough sample of independent observations, the sampling distribution will be approximately normal. Moreover, the standard error decreases as your sample size increase. In the following sections we will see a few different incarnations of the central limit theorem; the big picture will stay the same while the fine details change as we analyze different types of data.</p>
<p>This section focus on analyzing categorical variables. When making inferences about categorical variables it is best to analyze <em>proportions</em> because these generalize to populations much better than counts. In particular we want to look at the proportion of responses in a sample that take on a specific value of the categorical variable. We’ve seen this already, of course (see the last section for an example). The following subsections describe how to make inferences using a single sample proportion, two sample proportions, or (in some sense) many sample proportions.</p>
<div id="single-sample-proportion" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Single sample proportion<a href="inferential-statistics-take-1.html#single-sample-proportion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When analyzing a single categorical variable, the most basic parameter to make an inference about is the population proportion <span class="math inline">\(p\)</span>, the proportion of the population taking on a particular value of the categorical variable. For example, the proportion of American adults in 2010 that do not have a high school diploma. We use sample proportions <span class="math inline">\(\hat{p}\)</span> to make inferences about <span class="math inline">\(p\)</span> and under the right circumstances can apply the Central Limit Theorem to understand the distribution of sample proportions.</p>
<ul>
<li><p><strong>Sample statistic</strong>: sample proportion <span class="math inline">\(\hat{p}\)</span></p></li>
<li><p><strong>Population parameter</strong>: population proportion <span class="math inline">\(p\)</span></p></li>
<li><p>The <strong>Central Limit Theorem for a Single-sample Proportion</strong> states that if you</p>
<ul>
<li><p>have a sample of <span class="math inline">\(n\)</span> independent observations (hard to guarantee, but safe to assume if n &lt; 10% of the populatino and you employ random sampling) and</p></li>
<li><p>and at least 10 (expected) success and failures (ie <span class="math inline">\(\hat{p}n \geq 10\)</span> and <span class="math inline">\((1- \hat{p})n \geq 10\)</span> )</p></li>
</ul>
<p>Then the sampling distribution of <span class="math inline">\(\hat{p}\)</span> is approximately normal with a mean of <span class="math inline">\(p\)</span> and standard error <span class="math inline">\(SE = \sqrt{ \frac{p(1-p)}{n}}\)</span>. In symbols:
<span class="math display">\[ \hat{p} \sim N \left( \text{mean} = p, SE =\sqrt{ \frac{p(1-p)}{n}} \right) \]</span></p>
<p>Moreover, if <span class="math inline">\(p\)</span> is unknown (as it usually is!),
<span class="math display">\[ SE \approx \sqrt{ \frac{\hat{p}(1-\hat{p})}{n}}\]</span>
In other words, you can approximate the standard error using the sample proportion.</p></li>
</ul>
<p>In this situation, the hypotheses you need to meet in order to apply the Central Limit Theorem are typically easy to satisfy, which means we can use the CLT to make inferences in all of our favorite ways!</p>
<div id="confidence-intervals-1" class="section level4 hasAnchor" number="6.2.1.1">
<h4><span class="header-section-number">6.2.1.1</span> Confidence intervals<a href="inferential-statistics-take-1.html#confidence-intervals-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Suppose you have a sample of <span class="math inline">\(n\)</span> observations that meets the conditions for applying the Central Limit Theorem. Then the distribution of sample proportions is approximately normal, centered at the true population proportion with a standard error of</p>
<p><span class="math display">\[ SE \approx \sqrt{ \frac{\hat{p}(1-\hat{p})}{n}}.\]</span></p>
<p>We can use these facts to calculate a confidence interval to estimate the population proportion. Recall that every confidence interval has the form</p>
<p><span class="math display">\[ \text{point estimate} \pm CV \cdot SE\]</span></p>
<p>where <span class="math inline">\(CV\)</span> is the critical value determined by the confidence level. The <strong>CLT</strong> provides the standard error and our sample gives the point estimate, so we only need to worry about the critical value. Recall that if your confidence level is <span class="math inline">\(CL\)</span>, then <span class="math inline">\(CL\)</span>% of all sample proportions will fall within <span class="math inline">\(CV\)</span> standard deviations of the true population parameter within the sampling distribution. The sampling distribution is normal by the Central Limit theorem, so we can use the <code>qnorm(...)</code> function to find precise critical values.</p>
<p>As an example, let’s find the critical value for a 95% confidence interval. We want to find the value <span class="math inline">\(z^\ast\)</span> so that 95% of all sample proportions fall within <span class="math inline">\(z^\ast\)</span> standard deviations of the population proportion. In other words, we need to find <span class="math inline">\(z^\ast\)</span> so that <span class="math inline">\(P ( |Z| \leq z^\ast ) = .95\)</span>. The graph below helps visualize the setup.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-204-1.png" width="672" /></p>
<p>We can see that the bounds are almost <span class="math inline">\(\pm2\)</span>, but not quite. If the central area is .95, then the tail area is .05. The upper and lower tails are symmetric, so the upper tail area is .025. Thus, to find our critical value, we simply evaluate</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="inferential-statistics-take-1.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(.<span class="dv">025</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 1.959964</code></pre>
<p>Let’s use the same idea to find the critical values for some common confidence levels.</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="inferential-statistics-take-1.html#cb363-1" aria-hidden="true" tabindex="-1"></a>cvTable <span class="ot">&lt;-</span> <span class="fu">tibble</span>( <span class="at">conf.level =</span> <span class="fu">c</span>(.<span class="dv">9</span>, .<span class="dv">95</span>, .<span class="dv">98</span>, .<span class="dv">99</span>), </span>
<span id="cb363-2"><a href="inferential-statistics-take-1.html#cb363-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">crit.val =</span> <span class="fu">qnorm</span>( (<span class="dv">1</span> <span class="sc">-</span> conf.level)<span class="sc">/</span><span class="dv">2</span>, <span class="at">lower.tail =</span>F))</span>
<span id="cb363-3"><a href="inferential-statistics-take-1.html#cb363-3" aria-hidden="true" tabindex="-1"></a>cvTable</span></code></pre></div>
<pre><code>## # A tibble: 4 × 2
##   conf.level crit.val
##        &lt;dbl&gt;    &lt;dbl&gt;
## 1       0.9      1.64
## 2       0.95     1.96
## 3       0.98     2.33
## 4       0.99     2.58</code></pre>
<p>With that taken care of, we can calculate confidence intervals for any proportion we want at any confidence level! In particular, an <span class="math inline">\(\alpha\)</span>% confidence level for a single proportion is</p>
<p><span class="math display">\[\hat{p} \pm z^\ast_\alpha \cdot \sqrt{\frac{\hat{p}(1-\hat{p})}{n}}.  \]</span></p>
<p>Note there that this really is the same formula as above just with the details of the <strong>CLT</strong> filled in.</p>
<p>Let’s close this off with an example, recreating what we did in the last section to estimate the proportion of American adults without high school degrees. As a reminder, this is from the <code>gss2010</code> data set from the <code>openintro</code> package.</p>
<p>The code chunk below goes through the calculation of a 95% confidence interval for the proportion in question.</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="inferential-statistics-take-1.html#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="co"># components of CI</span></span>
<span id="cb365-2"><a href="inferential-statistics-take-1.html#cb365-2" aria-hidden="true" tabindex="-1"></a>pHat <span class="ot">&lt;-</span> <span class="fu">sum</span>( gss2010<span class="sc">$</span>degree <span class="sc">==</span> <span class="st">&quot;LT HIGH SCHOOL&quot;</span>) <span class="sc">/</span> <span class="fu">length</span>(gss2010<span class="sc">$</span>degree)</span>
<span id="cb365-3"><a href="inferential-statistics-take-1.html#cb365-3" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pHat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pHat)<span class="sc">/</span><span class="fu">length</span>(gss2010<span class="sc">$</span>degree))</span>
<span id="cb365-4"><a href="inferential-statistics-take-1.html#cb365-4" aria-hidden="true" tabindex="-1"></a>zCrit <span class="ot">&lt;-</span> <span class="fu">qnorm</span>( (<span class="dv">1</span> <span class="sc">-</span> .<span class="dv">95</span>)<span class="sc">/</span><span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb365-5"><a href="inferential-statistics-take-1.html#cb365-5" aria-hidden="true" tabindex="-1"></a><span class="co"># CI</span></span>
<span id="cb365-6"><a href="inferential-statistics-take-1.html#cb365-6" aria-hidden="true" tabindex="-1"></a>pHat <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">*</span>zCrit<span class="sc">*</span>SE</span></code></pre></div>
<pre><code>## [1] 0.1337709 0.1646636</code></pre>
<p>So with 95% confidence, between 13.4% and 16.5% of all Americans in 2010 did not have a high school diploma. Compare this to the simulated example from the previous section: the confidence intervals are almost identical! You can think of this as the central limit theorem verifying simulations or simulations verifying the central limit theorem. In their case, it’s cool!</p>
<p>Next up, we’ll learn how to perform hypothesis tests using theoretical sampling distributions.</p>
</div>
<div id="hypothesis-testing" class="section level4 hasAnchor" number="6.2.1.2">
<h4><span class="header-section-number">6.2.1.2</span> Hypothesis testing<a href="inferential-statistics-take-1.html#hypothesis-testing" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Suppose you have a sample of <span class="math inline">\(n\)</span> observations and you’d like to perform a hypothesis test using this sample. Recall that you assume the null hypothesis is true when performing a hypothesis test. Thus, in order to apply the Central Limit Theorem, we need to make sure our sample is sufficiently large <em>under the null hypothesis</em>.</p>
<p>More explicitly, suppose the null proportion is <span class="math inline">\(p_0\)</span>. If</p>
<ul>
<li><p>your sample has <span class="math inline">\(n\)</span> independent observations and</p></li>
<li><p>your sample has at least 10 <em>expected</em> success and failures, ie <span class="math inline">\(n p_0 \geq 10\)</span> and <span class="math inline">\(n (1- p_0) \geq 10\)</span></p></li>
</ul>
<p>then the distribution of sample proportions is approximately normal:</p>
<p><span class="math display">\[ \hat{p} \sim N\left( \text{mean} = p_0 , SE = \sqrt{\frac{p_0(1-p_0)}{n}} \right). \]</span></p>
<p>We can use use this sampling distribution to calculate <span class="math inline">\(p\)</span>-values thus execute hypothesis tests. We will show how to do this first with the toy examples from the last section which demonstrate the three types of hypothesis tests then one last time using the familiar <code>gss2010</code> data.</p>
<p>For the next three examples, suppose we have a sample of <span class="math inline">\(n = 200\)</span> independent observations and a sample proportion of <span class="math inline">\(\hat{p} = .55\)</span>. We will perform three hypothesis tests to see if our sample provides sufficient evidence to conclude that the true population proportion is greater than .5, less than .5, or different from .5 using a siginificance level of <span class="math inline">\(\alpha = .05\)</span>.</p>
<p>In all cases, note that <span class="math inline">\(.5*200 = 100 \geq 10\)</span>, so the Central Limit Theorem applies. Furthermore</p>
<p><span class="math display">\[ \hat{p} \sim N\left(\text{mean} = .5, SE = \sqrt{\frac{.5\cdot .5}{200}} \right)  \]</span></p>
<ol style="list-style-type: decimal">
<li><p><strong>Two-sided hypothesis test:</strong> Our hypothesis test is</p>
<p><span class="math display">\[\begin{array}{cc}
H_0: p = .5 \\
H_a: p \neq .5
\end{array}
\]</span></p>
<p>and the image below helps us visualize the <span class="math inline">\(p\)</span>-value of our sample with <span class="math inline">\(\hat{p} = .55\)</span></p>
<p><img src="_main_files/figure-html/unnamed-chunk-208-1.png" width="672" /></p>
<p>The upper and lower tails of the <span class="math inline">\(p\)</span>-value are symmetric about the mean, so we can calculate one of them and double it.</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="inferential-statistics-take-1.html#cb367-1" aria-hidden="true" tabindex="-1"></a>pNull <span class="ot">&lt;-</span> .<span class="dv">5</span></span>
<span id="cb367-2"><a href="inferential-statistics-take-1.html#cb367-2" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pNull<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> pNull)<span class="sc">/</span><span class="dv">200</span>)</span>
<span id="cb367-3"><a href="inferential-statistics-take-1.html#cb367-3" aria-hidden="true" tabindex="-1"></a>pHat <span class="ot">&lt;-</span> .<span class="dv">55</span></span>
<span id="cb367-4"><a href="inferential-statistics-take-1.html#cb367-4" aria-hidden="true" tabindex="-1"></a>pVal <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pnorm</span>(.<span class="dv">55</span>, <span class="at">mean =</span> pNull, <span class="at">sd =</span> SE, <span class="at">lower.tail =</span> F)</span>
<span id="cb367-5"><a href="inferential-statistics-take-1.html#cb367-5" aria-hidden="true" tabindex="-1"></a>pVal</span></code></pre></div>
<pre><code>## [1] 0.1572992</code></pre>
<p>With a <span class="math inline">\(p\)</span>-value of approximately .16 we fail to reject the null hypothesis. The data do not provide compelling evidence of a difference.</p></li>
<li><p><strong>One-Sided Upper Hypothesis test:</strong> Our hypothesis test is</p>
<p><span class="math display">\[\begin{array}{cc}
H_0: p = .5 \\
H_a: p &gt; .5
\end{array}
\]</span></p>
<p>and the image below helps us visualize the <span class="math inline">\(p\)</span>-value of our sample with <span class="math inline">\(\hat{p} = .55\)</span></p>
<p><img src="_main_files/figure-html/unnamed-chunk-210-1.png" width="672" /></p>
<p>The <span class="math inline">\(p\)</span>-value is the shaded upper tail area and can be calculated as follows.</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="inferential-statistics-take-1.html#cb369-1" aria-hidden="true" tabindex="-1"></a>pNull <span class="ot">&lt;-</span> .<span class="dv">5</span></span>
<span id="cb369-2"><a href="inferential-statistics-take-1.html#cb369-2" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pNull<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> pNull)<span class="sc">/</span><span class="dv">200</span>)</span>
<span id="cb369-3"><a href="inferential-statistics-take-1.html#cb369-3" aria-hidden="true" tabindex="-1"></a>pHat <span class="ot">&lt;-</span> .<span class="dv">55</span></span>
<span id="cb369-4"><a href="inferential-statistics-take-1.html#cb369-4" aria-hidden="true" tabindex="-1"></a>pVal <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(.<span class="dv">55</span>, <span class="at">mean =</span> pNull, <span class="at">sd =</span> SE, <span class="at">lower.tail =</span> F)</span>
<span id="cb369-5"><a href="inferential-statistics-take-1.html#cb369-5" aria-hidden="true" tabindex="-1"></a>pVal</span></code></pre></div>
<pre><code>## [1] 0.0786496</code></pre>
<p>With a <span class="math inline">\(p\)</span>-value of approximately .08 we fail to reject the null hypothesis at a significance level of <span class="math inline">\(\alpha =.05\)</span> . The data do not provide compelling evidence that the true proportion is greater than .5.</p></li>
<li><p><strong>One-Sided Lower Hypothesis test:</strong> Our hypothesis test is</p>
<p><span class="math display">\[\begin{array}{cc}
H_0: p = .5 \\
H_a: p &lt; .5
\end{array}
\]</span></p>
<p>and the image below helps us visualize the <span class="math inline">\(p\)</span>-value of our sample with <span class="math inline">\(\hat{p} = .55\)</span></p>
<p><img src="_main_files/figure-html/unnamed-chunk-212-1.png" width="672" /></p>
<p>The <span class="math inline">\(p\)</span>-value is the shaded llower tail area and can be calculated as follows.</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="inferential-statistics-take-1.html#cb371-1" aria-hidden="true" tabindex="-1"></a>pNull <span class="ot">&lt;-</span> .<span class="dv">5</span></span>
<span id="cb371-2"><a href="inferential-statistics-take-1.html#cb371-2" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pNull<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> pNull)<span class="sc">/</span><span class="dv">200</span>)</span>
<span id="cb371-3"><a href="inferential-statistics-take-1.html#cb371-3" aria-hidden="true" tabindex="-1"></a>pHat <span class="ot">&lt;-</span> .<span class="dv">55</span></span>
<span id="cb371-4"><a href="inferential-statistics-take-1.html#cb371-4" aria-hidden="true" tabindex="-1"></a>pVal <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(.<span class="dv">55</span>, <span class="at">mean =</span> pNull, <span class="at">sd =</span> SE)</span>
<span id="cb371-5"><a href="inferential-statistics-take-1.html#cb371-5" aria-hidden="true" tabindex="-1"></a>pVal</span></code></pre></div>
<pre><code>## [1] 0.9213504</code></pre>
<p>No suprise here. With a <span class="math inline">\(p\)</span>-value of approximately .92 we fail to reject the null hypothesis at a significance level of <span class="math inline">\(\alpha =.05\)</span> . The data do not provide compelling evidence that the true proportion is less than .5.</p></li>
</ol>
<p>We close this section using the <code>gss2010</code> data to perform a hypothesis test to see if more than 10% of Americans in 2010 did not have a high school diploma. Again we’ll use a significance level of <span class="math inline">\(\alpha = .05\)</span>. Recall the following sample size and statistic from earlier.</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="inferential-statistics-take-1.html#cb373-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(gss2010<span class="sc">$</span>degree)</span>
<span id="cb373-2"><a href="inferential-statistics-take-1.html#cb373-2" aria-hidden="true" tabindex="-1"></a>n</span></code></pre></div>
<pre><code>## [1] 2044</code></pre>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="inferential-statistics-take-1.html#cb375-1" aria-hidden="true" tabindex="-1"></a>pHat <span class="ot">&lt;-</span> <span class="fu">sum</span>(gss2010<span class="sc">$</span>degree <span class="sc">==</span> <span class="st">&quot;LT HIGH SCHOOL&quot;</span>)<span class="sc">/</span>n</span>
<span id="cb375-2"><a href="inferential-statistics-take-1.html#cb375-2" aria-hidden="true" tabindex="-1"></a>pHat</span></code></pre></div>
<pre><code>## [1] 0.1492172</code></pre>
<p>We reformulate our question as a hypothesis test.</p>
<p><span class="math display">\[\begin{array}{cc}
H_0: p = .1 \\
H_a: p &gt; .1
\end{array}
\]</span></p>
<p>We assume the observations in the <code>gss2010</code> data set are independent. Before preceding with the hypothesis test, we need to make sure our sample size is sufficiently large so that we can use the Central Limit Theorem.</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="inferential-statistics-take-1.html#cb377-1" aria-hidden="true" tabindex="-1"></a>pNull <span class="ot">&lt;-</span> .<span class="dv">1</span></span>
<span id="cb377-2"><a href="inferential-statistics-take-1.html#cb377-2" aria-hidden="true" tabindex="-1"></a><span class="co"># will return a logical, T/F </span></span>
<span id="cb377-3"><a href="inferential-statistics-take-1.html#cb377-3" aria-hidden="true" tabindex="-1"></a>n<span class="sc">*</span>pNull <span class="sc">&gt;=</span> <span class="dv">10</span> </span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="inferential-statistics-take-1.html#cb379-1" aria-hidden="true" tabindex="-1"></a>n<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> pNull) <span class="sc">&gt;=</span> <span class="dv">10</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Since the calculation above returned two <code>TRUE</code>’s we’re good to go! The CLT implies.</p>
<p><span class="math display">\[ \hat{p} \sim N \left(\text{mean} = .1, SE = \sqrt{\frac{.1\cdot.9}{2044}} \right)\]</span></p>
<p>We are performing a one-sided upper hypothesis test, so our <span class="math inline">\(p\)</span>-value is</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="inferential-statistics-take-1.html#cb381-1" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pNull<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span> pNull)<span class="sc">/</span>n)</span>
<span id="cb381-2"><a href="inferential-statistics-take-1.html#cb381-2" aria-hidden="true" tabindex="-1"></a>pValue <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(pHat, <span class="at">mean =</span> pNull, <span class="at">sd =</span> SE, <span class="at">lower.tail =</span> F)</span>
<span id="cb381-3"><a href="inferential-statistics-take-1.html#cb381-3" aria-hidden="true" tabindex="-1"></a>pValue </span></code></pre></div>
<pre><code>## [1] 5.983973e-14</code></pre>
<p>Since <span class="math inline">\(0 &lt; .05 = \alpha\)</span>, we reject the null and accept the research. Our data provide sufficient evidence to believe that more than 10% of Americans in 2010 did not have a high school diploma.</p>
<p>This <span class="math inline">\(p\)</span>-value is the same as the one we calculated in the previous section! This is no surprise: you can either think of this example as a check on simulation techniques or as the simulation techniques as a check on the central limit theorem.</p>
</div>
</div>
<div id="two-sample-proportion" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Two sample proportion<a href="inferential-statistics-take-1.html#two-sample-proportion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We often want to compare the same measurement or parameter for two different populations. As usual, we almost never know any single population parameter, so the best we can do is take a sample from each population and compare the sample statistics. When analyzing a categorical variable, we end up comparing sample proportions to make inferences about population proportions.</p>
<p>To make this more precise, suppose you’re investigating some proportion for two populations.</p>
<ul>
<li><p>Our population parameter of interest is <span class="math inline">\(p_1 - p2\)</span></p></li>
<li><p>Our sample statistic is <span class="math inline">\(\hat{p}_1- \hat{p}_2\)</span></p></li>
</ul>
<p>To make an inference about the population parameter, we need to learn about the sampling distribution of <span class="math inline">\(\hat{p}_1- \hat{p}_2\)</span>. Fortunately, if we can apply the central limit theorem for each sample individually, a version of the central limit theorem applies again! The formula for the standard error looks more complicated, but note that the variance of the sampling distrubtion for <span class="math inline">\(\hat{p}_1- \hat{p}_2\)</span> is just the sum of the variances for each each of the individual sampling distributions.</p>
<p><strong>CLT for two sample proportions</strong>: Suppose you are analyzing the difference between two population proportions <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span>, take two samples of size <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span> from each population respectively. If</p>
<ul>
<li><p>the observations within each sample are independent from one another,</p></li>
<li><p>the observations between the samples are independent, and</p></li>
<li><p>each sample has at least ten expected or observed success and failures (ie <span class="math inline">\(n_ip_i \geq 10\)</span> and <span class="math inline">\(n_i(1 - p_i) \geq 10\)</span> for <span class="math inline">\(i= 1,2\)</span>)</p></li>
</ul>
<p>Then the sampling distribution for <span class="math inline">\(\hat{p}_1- \hat{p}_2\)</span> is approximately normally distributed. In particular,</p>
<p><span class="math display">\[ \hat{p}_1- \hat{p}_2 \sim N\left( \text{mean} = p_1 - p_2 \text{ and } SE = \sqrt{\frac{p_1(1-p_1)}{n_1}+ \frac{p_2(1-p_2)}{n_2}} \right) \]</span></p>
<p>The details on how we employ the CLT for two sample proportions changes depending on whether we’d like to calculate a confidence interval or perform a hypothesis test. As above, this difference arise because <em>always assume the null hypothesis is true</em> when performing a hypothesis test. The following subsections highlight exactly what these differences entail, but, briefly, it only changes the standard error calculation.</p>
<div id="confidence-intervals-2" class="section level4 hasAnchor" number="6.2.2.1">
<h4><span class="header-section-number">6.2.2.1</span> Confidence intervals<a href="inferential-statistics-take-1.html#confidence-intervals-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As a reminder, the general formula for a confidence interval is</p>
<p><span class="math display">\[\text{point est.} \pm (\text{crit. val.})\cdot SE  \]</span></p>
<p>so to calculate and interpret a confidence interval for two sample proportions, we simply need to figure out each of these three pieces. We’ll do so by example using the <code>cancer_in_dogs</code> data set from the <code>openintro</code> R package.</p>
<p>This data set is the result of a 1994 study from 1994 designed to determine if exposure to the herbicide herbicide 2,4-Dichlorophenoxyacetic acid (2,4-D) increases dogs’ risk of developing cancer. Let’s calculate a 95% confidence interval estimating the difference in cancer rates between dogs exposed to the herbicide and those who are not.</p>
<p>There are 491 dogs in the data set who were exposed and 945 dogs that were not. The data set has two columns: <code>order</code> and <code>response</code>; the first indicates whether or not the dogs were exposed to the herbicide and the second indicates whether or not the dog developed cancer. Below we display 4 randomly selected rows from the dataset.</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="inferential-statistics-take-1.html#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_sample</span>(cancer_in_dogs, <span class="at">n =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 2
##   order    response 
##   &lt;fct&gt;    &lt;fct&gt;    
## 1 no 2,4-D no cancer
## 2 2,4-D    cancer   
## 3 2,4-D    cancer   
## 4 2,4-D    cancer</code></pre>
<p>Let <span class="math inline">\(p_1\)</span> denote the true proportion of dogs who are exposed to the herbicide and develop cancer; let <span class="math inline">\(p_2\)</span> denote the proportion of dogs who are not exposed but still develop cancer. We need to determine our sample proportions <span class="math inline">\(\hat{p}_1\)</span> and <span class="math inline">\(\hat{p}_2\)</span>. There are many ways to do this in R. A quick way is to use the <code>table(...)</code> function. Since the table only has two columns we can run the following to create a simple two-way table and store it in memory for future use.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="inferential-statistics-take-1.html#cb385-1" aria-hidden="true" tabindex="-1"></a>sumTab <span class="ot">&lt;-</span> <span class="fu">table</span>(cancer_in_dogs<span class="sc">$</span>response, cancer_in_dogs<span class="sc">$</span>order)</span>
<span id="cb385-2"><a href="inferential-statistics-take-1.html#cb385-2" aria-hidden="true" tabindex="-1"></a>sumTab <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">2,4-D</th>
<th align="right">no 2,4-D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">cancer</td>
<td align="right">191</td>
<td align="right">300</td>
</tr>
<tr class="even">
<td align="left">no cancer</td>
<td align="right">304</td>
<td align="right">641</td>
</tr>
</tbody>
</table>
<p>The columns in this two way table correspond to the samples of interest (ie the explanatory variable) and the rows the response variable. Thus, the denominator of our sample proportions will be the column sums and the numerators will be the entries in the <code>cancer</code> row.</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="inferential-statistics-take-1.html#cb386-1" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(sumTab[,<span class="dv">1</span>])</span>
<span id="cb386-2"><a href="inferential-statistics-take-1.html#cb386-2" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(sumTab[,<span class="dv">2</span>])</span>
<span id="cb386-3"><a href="inferential-statistics-take-1.html#cb386-3" aria-hidden="true" tabindex="-1"></a>pHat1 <span class="ot">&lt;-</span> sumTab[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">/</span> n1</span>
<span id="cb386-4"><a href="inferential-statistics-take-1.html#cb386-4" aria-hidden="true" tabindex="-1"></a>pHat2 <span class="ot">&lt;-</span> sumTab[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">/</span> n2 </span>
<span id="cb386-5"><a href="inferential-statistics-take-1.html#cb386-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(pHat1, pHat2)</span></code></pre></div>
<pre><code>## [1] 0.3858586 0.3188098</code></pre>
<p>When we calculate a confidence interval for two sample proportions, we’re estimating the <em>difference between the two proportions</em>, so our point estimate is</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="inferential-statistics-take-1.html#cb388-1" aria-hidden="true" tabindex="-1"></a>pDiff <span class="ot">&lt;-</span> pHat1 <span class="sc">-</span> pHat2</span>
<span id="cb388-2"><a href="inferential-statistics-take-1.html#cb388-2" aria-hidden="true" tabindex="-1"></a>pDiff</span></code></pre></div>
<pre><code>## [1] 0.06704881</code></pre>
<p>This means that roughly 6.7% <em>more</em> dogs exposed to the herbicide developed cancer in the sample data. Before we calculate a confidence interval, we need to make sure our samples meet the conditions needed to apply to Central Limit theorem.</p>
<ul>
<li><p>Independence within samples and between samples. The study employed random sampling for both groups and each sample size is less than 10% of its corresponding population. Moreover, the samples were taken independently of one another. We’re thus good to go here.</p></li>
<li><p>Sample size requirements. From the two-way table <code>sumTab</code> above we see that we have more than 10 successes (cancer) and failures (no cancer) in each group of dogs. Good to go here too!</p></li>
</ul>
<p>The CLT applies, so the sampling distribution of <span class="math inline">\(\hat{p}_1 - \hat{p}_2\)</span> is approximately normally distributed. Moreover, the standard error is</p>
<p><span class="math display">\[ SE \approx \sqrt{\frac{\hat{p}_1(1-\hat{p}_1)}{n_1}+ \frac{\hat{p}_2(1-\hat{p}_2)}{n_2}} \]</span></p>
<p>which we can now easily calculate!</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="inferential-statistics-take-1.html#cb390-1" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pHat1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span> pHat1)<span class="sc">/</span>n1 <span class="sc">+</span>  pHat2<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span> pHat2)<span class="sc">/</span>n2)</span>
<span id="cb390-2"><a href="inferential-statistics-take-1.html#cb390-2" aria-hidden="true" tabindex="-1"></a>SE</span></code></pre></div>
<pre><code>## [1] 0.02663677</code></pre>
<p>This means that if we repeated the study over and over we should expect about changes of about 2.7% between the various differences in sample proportions. We’re finally ready to calculate our confidence interval! Since the sampling distribution is approximately normal, our the critical value for our 95% confidence interval is</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="inferential-statistics-take-1.html#cb392-1" aria-hidden="true" tabindex="-1"></a>zCrit <span class="ot">&lt;-</span> <span class="fu">qnorm</span>( (<span class="dv">1</span><span class="fl">-.95</span>)<span class="sc">/</span><span class="dv">2</span>, <span class="at">lower.tail =</span> F)</span></code></pre></div>
<p>and our confidence interval is</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="inferential-statistics-take-1.html#cb393-1" aria-hidden="true" tabindex="-1"></a>ciDiff <span class="ot">&lt;-</span> pDiff <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)<span class="sc">*</span>zCrit<span class="sc">*</span>SE</span>
<span id="cb393-2"><a href="inferential-statistics-take-1.html#cb393-2" aria-hidden="true" tabindex="-1"></a>ciDiff</span></code></pre></div>
<pre><code>## [1] 0.01484171 0.11925591</code></pre>
<p>How should we interpret this confidence interval? Remember, we’re estimating the difference in cancer rates between dogs who were exposed to the herbicide and those who were not. Thus:</p>
<p>With 95% confidence, the cancer rate of dogs who are exposed to 2,4-Dichlorophenoxyacetic acid is between 1.5% and 11.9% <em>higher</em> than dogs who were not exposed to the herbicide.</p>
<p>The next section will go through hypothesis testing using the same data.</p>
</div>
<div id="hypothesis-testing-1" class="section level4 hasAnchor" number="6.2.2.2">
<h4><span class="header-section-number">6.2.2.2</span> Hypothesis testing<a href="inferential-statistics-take-1.html#hypothesis-testing-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Out in the wild you may want to simply check for a difference between two population proportions. The statistical inference for this is, of course, a hypothesis test. When you’re investigating a question like this your null and research hypotheses are</p>
<p><span class="math display">\[
\begin{array}{cl}
H_0: &amp; p_1 - p_2 = 0 \\
H_a: &amp; p_1 - p_2 \neq 0.
\end{array}
\]</span></p>
<p>The alternative hypothesis can by one-sided if you’d like; if it were <span class="math inline">\(p_1 - p_2 &gt; 0\)</span> you’d be asking if the first proportion is greater than the second and the opposite if it were <span class="math inline">\(p_1 - p_2 &lt; 0\)</span>. You’d could use a one sided hypothesis test to answer a question like “are there proportionally more Republicans in Montana than in Wyoming?”</p>
<p>As usual the CLT is the main tool for performing a 2-sample proportion hypothesis test. In this case we need to make sure that</p>
<ul>
<li><p>our observations are independent within and between groups</p></li>
<li><p>each sample has at least 10 <em>expected</em> success and failures.</p></li>
</ul>
<p>There’s a small difficulty we need to deal with here. Recall that we <strong>always assume the null hypothesis is true when performing a hypothesis test.</strong> In this case that only means <span class="math inline">\(p_1 = p_2\)</span>, but it doesn’t make any claim about what these proportions are actually equal to. The remedy is to estimate this value using a <em>pooled proportion</em>. Suppose your first and second samples have <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span> observations respectively and <span class="math inline">\(suc_1\)</span> and <span class="math inline">\(suc_2\)</span> successes. The <em>pooled sample proportion</em> is</p>
<p><span class="math display">\[
\begin{array}{ccc}
\hat{p}_{pool} &amp; = &amp; \frac{suc_1 + suc_2}{n_1 + n_2} \\
&amp; = &amp; \frac{ \hat{p}_1 n_1 + \hat{p}_2 n_2}{n_1 + n_2}
\end{array}
\]</span>
or, in words, the pooled proportion is the total number of successes in both samples divided by the total number of observations. We use <span class="math inline">\(\hat{p}_{pool}\)</span> to assess the sample size requirements and in the formula for the standard error if our samples meet the conditions to apply the CLT. Let’s see how this plays out using the herbicide and cancer in dogs example from the last section. A two-way table summarizing the results of the experiment is below.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="inferential-statistics-take-1.html#cb395-1" aria-hidden="true" tabindex="-1"></a>sumTab <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">2,4-D</th>
<th align="right">no 2,4-D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">cancer</td>
<td align="right">191</td>
<td align="right">300</td>
</tr>
<tr class="even">
<td align="left">no cancer</td>
<td align="right">304</td>
<td align="right">641</td>
</tr>
</tbody>
</table>
<p>The pooled proportion is the sum of the first row of this table divided by the sum of all entries in this table.</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="inferential-statistics-take-1.html#cb396-1" aria-hidden="true" tabindex="-1"></a>pPool <span class="ot">&lt;-</span> <span class="fu">sum</span>(sumTab[<span class="dv">1</span>,])<span class="sc">/</span><span class="fu">sum</span>(sumTab)</span>
<span id="cb396-2"><a href="inferential-statistics-take-1.html#cb396-2" aria-hidden="true" tabindex="-1"></a>pPool </span></code></pre></div>
<pre><code>## [1] 0.341922</code></pre>
<p>In other words, if we ignored herbicide exposure about 34% of the dogs in our sample developed cancer. We use this proportion to ensure that our samples are both large enough to apply the central limit theorem.</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="inferential-statistics-take-1.html#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>( n1<span class="sc">*</span>pPool, n1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pPool))</span></code></pre></div>
<pre><code>## [1] 169.2514 325.7486</code></pre>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="inferential-statistics-take-1.html#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>( n2<span class="sc">*</span>pPool, n2<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pPool))</span></code></pre></div>
<pre><code>## [1] 321.7486 619.2514</code></pre>
<p>Thus both of our samples have at least 10 expected success and expected failures, so we can apply the CLT! Remember we’re assuming that the null hypothesis is true and in turn that <span class="math display">\[p_1 = p_2 \approx \hat{p}_{pool}\]</span>. Thus</p>
<p><span class="math display">\[
\begin{array}{ccc}
SE &amp; = &amp; \sqrt{\frac{p_1(1-p_1)}{n_1}+ \frac{p_2(1-p_2)}{n_2}} \\ &amp; \approx &amp; \sqrt{\frac{\hat{p}_{pool}(1-\hat{p}_{pool})}{n_1} + \frac{\hat{p}_{pool}(1-\hat{p}_{pool})}{n_2}}
\end{array}
\]</span></p>
<p>The calculation for our current working example is below.</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="inferential-statistics-take-1.html#cb402-1" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>( pPool<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pPool)<span class="sc">/</span>n1 <span class="sc">+</span> pPool<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pPool)<span class="sc">/</span>n2) </span>
<span id="cb402-2"><a href="inferential-statistics-take-1.html#cb402-2" aria-hidden="true" tabindex="-1"></a>SE</span></code></pre></div>
<pre><code>## [1] 0.02633795</code></pre>
<p>We’re finally ready to calculate the <span class="math inline">\(p\)</span>-value for this experiment. Let’s perform this hypothesis test with a significance level of <span class="math inline">\(\alpha = .05\)</span>.</p>
<p>Our point estimate of <span class="math inline">\(p_1 - p2\)</span> is <code>pDiff</code> below.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="inferential-statistics-take-1.html#cb404-1" aria-hidden="true" tabindex="-1"></a>pHat1 <span class="ot">&lt;-</span> sumTab[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">/</span> n1</span>
<span id="cb404-2"><a href="inferential-statistics-take-1.html#cb404-2" aria-hidden="true" tabindex="-1"></a>pHat2 <span class="ot">&lt;-</span> sumTab[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">/</span> n2 </span>
<span id="cb404-3"><a href="inferential-statistics-take-1.html#cb404-3" aria-hidden="true" tabindex="-1"></a>pDiff <span class="ot">&lt;-</span> pHat1 <span class="sc">-</span> pHat2</span>
<span id="cb404-4"><a href="inferential-statistics-take-1.html#cb404-4" aria-hidden="true" tabindex="-1"></a>pDiff</span></code></pre></div>
<pre><code>## [1] 0.06704881</code></pre>
<p>The test statistic, which in this case is a <span class="math inline">\(Z\)</span>-score, of our data is</p>
<p><span class="math display">\[
\begin{array}{ccc}
Z &amp; = &amp;  \frac{\text{point est.} - \text{null value}}{SE} \\
&amp; = &amp; \frac{ \hat{p}_1 - \hat{p}_2}{SE}
\end{array}
\]</span></p>
<p>or as follows in R.</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="inferential-statistics-take-1.html#cb406-1" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> pDiff <span class="sc">/</span> SE </span>
<span id="cb406-2"><a href="inferential-statistics-take-1.html#cb406-2" aria-hidden="true" tabindex="-1"></a>Z</span></code></pre></div>
<pre><code>## [1] 2.545711</code></pre>
<p>Since <span class="math inline">\(Z &gt;0\)</span> the <span class="math inline">\(p\)</span>-value of our hypothesis test is</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="inferential-statistics-take-1.html#cb408-1" aria-hidden="true" tabindex="-1"></a>pVal <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pnorm</span>(Z,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb408-2"><a href="inferential-statistics-take-1.html#cb408-2" aria-hidden="true" tabindex="-1"></a>pVal</span></code></pre></div>
<pre><code>## [1] 0.01090555</code></pre>
<p>In other words, if there were no difference between cancer rates in dogs exposed to the herbicide and those who were not there would be a 1.1% chance of observing data like our own or more extreme.</p>
<p>Since <span class="math inline">\(p &lt; \alpha = .05\)</span>, we reject the null and accept the research: The data provide compelling evidence to believe that there the cancer rate of dogs exposed to the herbicide is different from the rate of dogs who were not exposed.</p>
<p>Note that this may have been a good candidate for a one-sided hypothesis test since we’re not simply interested in detecting a difference. We may be more interested in seeing if dogs exposed to the herbicide developed cancer at greater rates than those who were not exposed. In this situation, it is common to perform a two-sided hypothesis test, but also report a confidence interval to indicate which side of the null value the true difference falls on if your tests results in a rejection of the null.</p>
</div>
</div>
<div id="chi-squared-tests" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Chi-squared tests<a href="inferential-statistics-take-1.html#chi-squared-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To do</p>
<div id="chi-squared-goodness-of-fit" class="section level4 hasAnchor" number="6.2.3.1">
<h4><span class="header-section-number">6.2.3.1</span> Chi-squared goodness of fit<a href="inferential-statistics-take-1.html#chi-squared-goodness-of-fit" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="chi-squared-test-of-independence" class="section level4 hasAnchor" number="6.2.3.2">
<h4><span class="header-section-number">6.2.3.2</span> Chi-squared test of independence<a href="inferential-statistics-take-1.html#chi-squared-test-of-independence" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
</div>
<div id="analyzing-numerical-variables" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Analyzing numerical variables<a href="inferential-statistics-take-1.html#analyzing-numerical-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="single-sample-mean" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Single sample mean<a href="inferential-statistics-take-1.html#single-sample-mean" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="confidence-intervals-3" class="section level4 hasAnchor" number="6.3.1.1">
<h4><span class="header-section-number">6.3.1.1</span> Confidence intervals<a href="inferential-statistics-take-1.html#confidence-intervals-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="hypothesis-testing-2" class="section level4 hasAnchor" number="6.3.1.2">
<h4><span class="header-section-number">6.3.1.2</span> Hypothesis testing<a href="inferential-statistics-take-1.html#hypothesis-testing-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="two-sample-mean" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Two sample mean<a href="inferential-statistics-take-1.html#two-sample-mean" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="confidence-intervals-4" class="section level4 hasAnchor" number="6.3.2.1">
<h4><span class="header-section-number">6.3.2.1</span> Confidence intervals<a href="inferential-statistics-take-1.html#confidence-intervals-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="hypothesis-testing-3" class="section level4 hasAnchor" number="6.3.2.2">
<h4><span class="header-section-number">6.3.2.2</span> Hypothesis testing<a href="inferential-statistics-take-1.html#hypothesis-testing-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="paired-data" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Paired data<a href="inferential-statistics-take-1.html#paired-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="confidence-intervals-5" class="section level4 hasAnchor" number="6.3.3.1">
<h4><span class="header-section-number">6.3.3.1</span> Confidence intervals<a href="inferential-statistics-take-1.html#confidence-intervals-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="hypothesis-testing-4" class="section level4 hasAnchor" number="6.3.3.2">
<h4><span class="header-section-number">6.3.3.2</span> Hypothesis testing<a href="inferential-statistics-take-1.html#hypothesis-testing-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="analysis-of-variance-anova" class="section level3 hasAnchor" number="6.3.4">
<h3><span class="header-section-number">6.3.4</span> Analysis of variance (ANOVA)<a href="inferential-statistics-take-1.html#analysis-of-variance-anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="distribution-calculations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="inferential-statistics-take-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-blocks.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
