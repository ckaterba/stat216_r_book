<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Modeling relationships | R and RStudio for STAT216</title>
  <meta name="description" content="<p>These notes introduce the reader to R and RStudio following the rough structure
of STAT216 at FVCC.</p>" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Modeling relationships | R and RStudio for STAT216" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>These notes introduce the reader to R and RStudio following the rough structure
of STAT216 at FVCC.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Modeling relationships | R and RStudio for STAT216" />
  
  <meta name="twitter:description" content="<p>These notes introduce the reader to R and RStudio following the rough structure
of STAT216 at FVCC.</p>" />
  

<meta name="author" content="Charles Katerba" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="inferential-statistics-take-2.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for STAT216 @ FVCC</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#organization"><i class="fa fa-check"></i><b>1.1</b> Organization</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#getting-started"><i class="fa fa-check"></i><b>1.2</b> Getting started</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#code-in-this-book"><i class="fa fa-check"></i><b>1.3</b> Code in this book</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#help"><i class="fa fa-check"></i><b>1.4</b> Help</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#debugging"><i class="fa fa-check"></i><b>1.5</b> Debugging</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#other-resources"><i class="fa fa-check"></i><b>1.6</b> Other resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rstudio-basics.html"><a href="rstudio-basics.html"><i class="fa fa-check"></i><b>2</b> RStudio basics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rstudio-basics.html"><a href="rstudio-basics.html#a-big-calculator"><i class="fa fa-check"></i><b>2.1</b> A big calculator</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="rstudio-basics.html"><a href="rstudio-basics.html#numbers"><i class="fa fa-check"></i><b>2.1.1</b> Numbers</a></li>
<li class="chapter" data-level="2.1.2" data-path="rstudio-basics.html"><a href="rstudio-basics.html#strings"><i class="fa fa-check"></i><b>2.1.2</b> Strings</a></li>
<li class="chapter" data-level="2.1.3" data-path="rstudio-basics.html"><a href="rstudio-basics.html#logicals-and-logical-operators"><i class="fa fa-check"></i><b>2.1.3</b> Logicals and Logical operators</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="rstudio-basics.html"><a href="rstudio-basics.html#naming-things"><i class="fa fa-check"></i><b>2.2</b> Naming things</a></li>
<li class="chapter" data-level="2.3" data-path="rstudio-basics.html"><a href="rstudio-basics.html#lists-and-vectors"><i class="fa fa-check"></i><b>2.3</b> Lists and vectors</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="rstudio-basics.html"><a href="rstudio-basics.html#creating-lists"><i class="fa fa-check"></i><b>2.3.1</b> Creating lists</a></li>
<li class="chapter" data-level="2.3.2" data-path="rstudio-basics.html"><a href="rstudio-basics.html#subsetting-lists"><i class="fa fa-check"></i><b>2.3.2</b> Subsetting lists</a></li>
<li class="chapter" data-level="2.3.3" data-path="rstudio-basics.html"><a href="rstudio-basics.html#special-lists"><i class="fa fa-check"></i><b>2.3.3</b> Special lists</a></li>
<li class="chapter" data-level="2.3.4" data-path="rstudio-basics.html"><a href="rstudio-basics.html#list-arithmetic"><i class="fa fa-check"></i><b>2.3.4</b> List arithmetic</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="rstudio-basics.html"><a href="rstudio-basics.html#packages"><i class="fa fa-check"></i><b>2.4</b> Packages</a></li>
<li class="chapter" data-level="2.5" data-path="rstudio-basics.html"><a href="rstudio-basics.html#data-frames-and-tibbles"><i class="fa fa-check"></i><b>2.5</b> Data frames and tibbles</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="rstudio-basics.html"><a href="rstudio-basics.html#creating-data-frames"><i class="fa fa-check"></i><b>2.5.1</b> Creating data frames</a></li>
<li class="chapter" data-level="2.5.2" data-path="rstudio-basics.html"><a href="rstudio-basics.html#using-data-frames"><i class="fa fa-check"></i><b>2.5.2</b> Using data frames</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="rstudio-basics.html"><a href="rstudio-basics.html#r-markdown-documents"><i class="fa fa-check"></i><b>2.6</b> R Markdown documents</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cross.html"><a href="cross.html"><i class="fa fa-check"></i><b>3</b> Summary statistics and data visualization</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cross.html"><a href="cross.html#summary-statistics-in-r"><i class="fa fa-check"></i><b>3.1</b> Summary statistics in R</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="cross.html"><a href="cross.html#numerical-variables"><i class="fa fa-check"></i><b>3.1.1</b> Numerical variables</a></li>
<li class="chapter" data-level="3.1.2" data-path="cross.html"><a href="cross.html#categorical-variables"><i class="fa fa-check"></i><b>3.1.2</b> Categorical variables</a></li>
<li class="chapter" data-level="3.1.3" data-path="cross.html"><a href="cross.html#combining-it-all"><i class="fa fa-check"></i><b>3.1.3</b> Combining it all</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="cross.html"><a href="cross.html#data-visualization"><i class="fa fa-check"></i><b>3.2</b> Data visualization</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="cross.html"><a href="cross.html#base-r"><i class="fa fa-check"></i><b>3.2.1</b> Base R</a></li>
<li class="chapter" data-level="3.2.2" data-path="cross.html"><a href="cross.html#ggplot2"><i class="fa fa-check"></i><b>3.2.2</b> <code>ggplot2</code></a></li>
<li class="chapter" data-level="3.2.3" data-path="cross.html"><a href="cross.html#saving-plots"><i class="fa fa-check"></i><b>3.2.3</b> Saving plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="wrangling-data.html"><a href="wrangling-data.html"><i class="fa fa-check"></i><b>4</b> Wrangling data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="wrangling-data.html"><a href="wrangling-data.html#the-goal-tidy-data."><i class="fa fa-check"></i><b>4.1</b> The goal: “tidy” data.</a></li>
<li class="chapter" data-level="4.2" data-path="wrangling-data.html"><a href="wrangling-data.html#the-pipe"><i class="fa fa-check"></i><b>4.2</b> The pipe</a></li>
<li class="chapter" data-level="4.3" data-path="wrangling-data.html"><a href="wrangling-data.html#common-tidying-operations"><i class="fa fa-check"></i><b>4.3</b> Common tidying operations</a></li>
<li class="chapter" data-level="4.4" data-path="wrangling-data.html"><a href="wrangling-data.html#mutate-group-by-and-summarize"><i class="fa fa-check"></i><b>4.4</b> Mutate, group by, and summarize</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="distribution-calculations.html"><a href="distribution-calculations.html"><i class="fa fa-check"></i><b>5</b> Distribution calculations</a>
<ul>
<li class="chapter" data-level="5.1" data-path="distribution-calculations.html"><a href="distribution-calculations.html#finite-discrete-distribution-calculations"><i class="fa fa-check"></i><b>5.1</b> Finite discrete distribution calculations</a></li>
<li class="chapter" data-level="5.2" data-path="distribution-calculations.html"><a href="distribution-calculations.html#named-distribution-calculations"><i class="fa fa-check"></i><b>5.2</b> Named distribution calculations</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="distribution-calculations.html"><a href="distribution-calculations.html#discrete-random-variables"><i class="fa fa-check"></i><b>5.2.1</b> Discrete random variables</a></li>
<li class="chapter" data-level="5.2.2" data-path="distribution-calculations.html"><a href="distribution-calculations.html#continuous-random-variables"><i class="fa fa-check"></i><b>5.2.2</b> Continuous random variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html"><i class="fa fa-check"></i><b>6</b> Inferential statistics: Take 1</a>
<ul>
<li class="chapter" data-level="6.1" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#basics-of-statistical-inference"><i class="fa fa-check"></i><b>6.1</b> Basics of statistical inference</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#sampling-distributions"><i class="fa fa-check"></i><b>6.1.1</b> Sampling distributions</a></li>
<li class="chapter" data-level="6.1.2" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#confidence-intervals"><i class="fa fa-check"></i><b>6.1.2</b> Confidence intervals</a></li>
<li class="chapter" data-level="6.1.3" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#hypothesis-tests"><i class="fa fa-check"></i><b>6.1.3</b> Hypothesis tests</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#analyzing-categorical-variables"><i class="fa fa-check"></i><b>6.2</b> Analyzing categorical variables</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#single-sample-proportion"><i class="fa fa-check"></i><b>6.2.1</b> Single sample proportion</a></li>
<li class="chapter" data-level="6.2.2" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#two-sample-proportion"><i class="fa fa-check"></i><b>6.2.2</b> Two sample proportion</a></li>
<li class="chapter" data-level="6.2.3" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#chi-squared-tests"><i class="fa fa-check"></i><b>6.2.3</b> Chi-squared tests</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#analyzing-numerical-variables"><i class="fa fa-check"></i><b>6.3</b> Analyzing numerical variables</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#single-sample-mean"><i class="fa fa-check"></i><b>6.3.1</b> Single sample mean</a></li>
<li class="chapter" data-level="6.3.2" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#two-sample-mean"><i class="fa fa-check"></i><b>6.3.2</b> Two sample mean</a></li>
<li class="chapter" data-level="6.3.3" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#paired-data"><i class="fa fa-check"></i><b>6.3.3</b> Paired data</a></li>
<li class="chapter" data-level="6.3.4" data-path="inferential-statistics-take-1.html"><a href="inferential-statistics-take-1.html#analysis-of-variance-anova"><i class="fa fa-check"></i><b>6.3.4</b> Analysis of variance (ANOVA)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html"><i class="fa fa-check"></i><b>7</b> Inferential statistics, take 2</a>
<ul>
<li class="chapter" data-level="7.1" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#analyzing-categorical-variables-1"><i class="fa fa-check"></i><b>7.1</b> Analyzing categorical variables</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#single-sample-proportions"><i class="fa fa-check"></i><b>7.1.1</b> Single sample proportions</a></li>
<li class="chapter" data-level="7.1.2" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#two-sample-proportions"><i class="fa fa-check"></i><b>7.1.2</b> Two sample proportions</a></li>
<li class="chapter" data-level="7.1.3" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#chi-squared-goodness-of-fit-test"><i class="fa fa-check"></i><b>7.1.3</b> Chi-squared goodness of fit test</a></li>
<li class="chapter" data-level="7.1.4" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#chi-squared-test-of-independence-1"><i class="fa fa-check"></i><b>7.1.4</b> Chi-squared test of independence</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#analyzing-numerical-variables-1"><i class="fa fa-check"></i><b>7.2</b> Analyzing numerical variables</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#single-sample-mean-1"><i class="fa fa-check"></i><b>7.2.1</b> Single sample mean</a></li>
<li class="chapter" data-level="7.2.2" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#two-sample-mean-comparison"><i class="fa fa-check"></i><b>7.2.2</b> Two sample mean comparison</a></li>
<li class="chapter" data-level="7.2.3" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#paired-data-1"><i class="fa fa-check"></i><b>7.2.3</b> Paired data</a></li>
<li class="chapter" data-level="7.2.4" data-path="inferential-statistics-take-2.html"><a href="inferential-statistics-take-2.html#analysis-of-variance-anova-1"><i class="fa fa-check"></i><b>7.2.4</b> Analysis of variance (ANOVA)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="modeling-relationships.html"><a href="modeling-relationships.html"><i class="fa fa-check"></i><b>8</b> Modeling relationships</a>
<ul>
<li class="chapter" data-level="8.1" data-path="modeling-relationships.html"><a href="modeling-relationships.html#simple-linear-regression"><i class="fa fa-check"></i><b>8.1</b> Simple linear regression</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="modeling-relationships.html"><a href="modeling-relationships.html#the-basics"><i class="fa fa-check"></i><b>8.1.1</b> The basics</a></li>
<li class="chapter" data-level="8.1.2" data-path="modeling-relationships.html"><a href="modeling-relationships.html#model-fit"><i class="fa fa-check"></i><b>8.1.2</b> Model fit</a></li>
<li class="chapter" data-level="8.1.3" data-path="modeling-relationships.html"><a href="modeling-relationships.html#hypothesis-testing-5"><i class="fa fa-check"></i><b>8.1.3</b> Hypothesis testing</a></li>
<li class="chapter" data-level="8.1.4" data-path="modeling-relationships.html"><a href="modeling-relationships.html#prediction"><i class="fa fa-check"></i><b>8.1.4</b> Prediction</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="modeling-relationships.html"><a href="modeling-relationships.html#multiple-linear-regression"><i class="fa fa-check"></i><b>8.2</b> Multiple linear regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R and RStudio for STAT216</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modeling-relationships" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Modeling relationships<a href="modeling-relationships.html#modeling-relationships" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>One crucial goal of inferential statistics is the attempt to detect relationships between variables. This goal is missing a conspicuous piece, however. Namely, if we detect a relationship between two variables, what does that relationship actually look like? This is where modeling comes in. A <strong>model</strong> is a precise mathematical description that approximates the relationship between two (or more) variables. Among other things, a model should be able to generate predictions/forecasts at different values for the explanatory variable(s).</p>
<p>If we think in terms of inputs and outputs, or <strong>explanatory variables</strong> and <strong>response variables</strong> and think back to what we’ve covered so far, we have actually been modeling relationships; it’s just that these models have been quite simple. For instance, you can think of a two-sample t-test as a way to test for an association between a two-valued categorical explanatory variable and a numerical response variable. If we detect an association, what would the corresponding model be? The input/explanatory variable is just one of two values and response would simply be an estimate of that average value of the response variable for that specific input.</p>
<p>As an example, imagine we hypothesize a relationship between cola preference and statistical aptitude. To test this, we sample 35 Pepsi drinkers and 35 Coke drinkers, then give them all a statistics test. We go through a two-sample t-test and determine that, in fact, there is a relationship between cola preference and statistical aptitude. After making this determination, how would you estimate the statistical aptitude of a Coke drinker? It turns out your best, most reliable guess (at least as a point estimate) would be to use the average score of Coke drinkers. What we’re describing here is a model and we can think of it as a function</p>
<p><span class="math display">\[f \colon \{Pepsi, Coke\}  = \begin{cases}
\overline{x}_{Pepsi} &amp; \text{if } Pepsi \\
\overline{x}_{Coke} &amp; \text{if } Coke
\end{cases}\]</span></p>
<p>You may be thinking “This seems to make things more complicated than it needs to be” and you are probably right to a certain degree. But the hope is that this perspective frames everything we’ve done in a way that makes the rest of what we’ll do make more sense.</p>
<p>In what comes we will finally start investigating relationships where one has a numerical explanatory variable and a numerical response variable. Our main tool for this investigation will be <strong>linear regression</strong> which is likely something you’ve seen before. Our hope is that the following chapter will soup up your understanding of linear regression and clarify some of the statistical ideas underpinning this tool. We will try to keep the formulas and math to a minimum, but a few will be necessary along the way.</p>
<div id="simple-linear-regression" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Simple linear regression<a href="modeling-relationships.html#simple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="the-basics" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> The basics<a href="modeling-relationships.html#the-basics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Relationships between numerical variables can take on many different forms, so we will start with the most simple and most common type: linear relationships. Recall that a relationship between numerical variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is linear if
<span class="math display">\[ Y = mX + b \text{ or to make it more statistical  } Y = \beta_0 + \beta_1 X + \epsilon. \]</span></p>
<p>The coefficients <span class="math inline">\(\beta_i\)</span> are <em>population parameters</em> and <span class="math inline">\(\epsilon\)</span> represents some random normally distributed noise with a mean of zero and a fixed standard deviation. This is meant to explain, to some extent, the data we witness when we are out in the wild; we almost never see the perfect linear relationships idealized by mathematics and there is almost always some noise that scatters data “around the true line.” The scatter plot below helps to visualize one possible relationship (this is using the <code>res_demo_1</code> data set from the <code>openintro</code> package).</p>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="modeling-relationships.html#cb675-1" tabindex="-1"></a><span class="fu">ggplot</span>(res_demo_1, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y_lin)) <span class="sc">+</span> </span>
<span id="cb675-2"><a href="modeling-relationships.html#cb675-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb675-3"><a href="modeling-relationships.html#cb675-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;A simulated linear relationship&#39;</span> )</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-400-1.png" width="672" /></p>
<p>As usual, we almost never know the population parameters, so we need some way to estimate them. This is where linear regression comes in as it is a procedure that generates point estimates for the slope any vertical intercepts of a linear relationship between two variables. Very briefly and roughly, linear regression finds the coefficients of a line that is “simultaneously closest to all data points.” To make this more precise, we need to introduce some terminology.</p>
<p>Suppose you have a collection of sample data <span class="math inline">\(S = \{(x_1, y_1), \ldots,(x_n,y_n) \}\)</span> and a line $ y= mx + b$ modeling the relationship between your <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> values. The <span class="math inline">\(i^{th}\)</span> residual of this model is
<span class="math display">\[ e_i = y_i - (mx_i + b) \]</span>
giving the “leftovers” of the data from the model fit. If <span class="math inline">\(e_i &gt; 0\)</span> then your model under estimated <span class="math inline">\(y_i\)</span> and if <span class="math inline">\(e_i &lt; 0\)</span> your model over estimated the data. Let’s make a guess for our simulation with the line <span class="math inline">\(y = -10 + 3.25x\)</span>. We’ll add our y estimates and a helper variable whose value depends only on the sign of the residual.</p>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb676-1"><a href="modeling-relationships.html#cb676-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> res_demo_1  <span class="sc">%&gt;%</span></span>
<span id="cb676-2"><a href="modeling-relationships.html#cb676-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y_guess =</span> <span class="sc">-</span><span class="dv">10</span> <span class="sc">+</span> <span class="fl">3.25</span><span class="sc">*</span>x</span>
<span id="cb676-3"><a href="modeling-relationships.html#cb676-3" tabindex="-1"></a>         , <span class="at">residual =</span> y_lin <span class="sc">-</span> y_guess</span>
<span id="cb676-4"><a href="modeling-relationships.html#cb676-4" tabindex="-1"></a>         , <span class="at">residual_grp =</span> <span class="fu">if_else</span>(y_lin <span class="sc">-</span> y_guess <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">&#39;under&#39;</span>, <span class="st">&#39;over&#39;</span>))</span></code></pre></div>
<p>Now let’s plot our estimated values, <code>y_gess</code>, the original data <code>y_lin</code>, and the residuals as vertical lines. The residuals have different colors depending on whether the original data lies above or below the line.</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="modeling-relationships.html#cb677-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y_lin)) <span class="sc">+</span> </span>
<span id="cb677-2"><a href="modeling-relationships.html#cb677-2" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">color =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb677-3"><a href="modeling-relationships.html#cb677-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y_guess), <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">shape =</span> <span class="dv">1</span> ) <span class="sc">+</span></span>
<span id="cb677-4"><a href="modeling-relationships.html#cb677-4" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> x, <span class="at">yend =</span> y_guess,  <span class="at">color =</span> residual_grp) ) <span class="sc">+</span></span>
<span id="cb677-5"><a href="modeling-relationships.html#cb677-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;An eyeballed line with residuals&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-402-1.png" width="672" /></p>
<p>Our line looks like a reasonable fit, but we also may have a suspicion that we could do better. We have to clear about what exactly we mean by better here. We don’t want to force the line to go through any specific points, but we want the residuals to be small. This means we should look for a line that <em>minimizes</em> the residuals. As we can see from the plot above, residuals can be both positive and negative, so we don’t want to try to minimize the sum of the residuals. Instead, we want to minimize the sum of squared error:</p>
<p><span class="math display">\[ SSE = \sum_{i=1}^n e_i^2 \]</span></p>
<p>We will skip the details, but <em>linear regression</em> produces the coefficients of the <strong>line of best fit</strong>, the line minimizing the SSE above. Looking at the plot above, you might suspect the line of best fit has a slightly smaller slope and a slightly larger vertical intercept. The plot below will compare our eyeballed guess line from above to the actual line of best fit.</p>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="modeling-relationships.html#cb678-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y_lin))<span class="sc">+</span></span>
<span id="cb678-2"><a href="modeling-relationships.html#cb678-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb678-3"><a href="modeling-relationships.html#cb678-3" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="fl">3.25</span>, <span class="at">intercept =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">color =</span> <span class="st">&#39;red&#39;</span>)  <span class="sc">+</span></span>
<span id="cb678-4"><a href="modeling-relationships.html#cb678-4" tabindex="-1"></a>  <span class="co"># the next line adds the true line of best fit</span></span>
<span id="cb678-5"><a href="modeling-relationships.html#cb678-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb678-6"><a href="modeling-relationships.html#cb678-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Our guess compared to the real line of best fit&#39;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-403-1.png" width="672" /></p>
<p>How can you actually find the line of best fit? <code>R</code> makes it quite easy! The syntax is almost identical to that which we used to run ANOVA tests in the last chapter, just with a different command. The basic syntax is</p>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="modeling-relationships.html#cb680-1" tabindex="-1"></a>lin.model <span class="ot">&lt;-</span> <span class="fu">lm</span>( y <span class="sc">~</span> x, <span class="at">data =</span> df)</span></code></pre></div>
<p>and this generates a model object and stores it as the value <code>lin.model</code>. Once you’ve done this, you can inspect the details with</p>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="modeling-relationships.html#cb681-1" tabindex="-1"></a><span class="fu">summary</span>(lin.model)</span></code></pre></div>
<p>Let’s run this on our simulated example and inspect the output.</p>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="modeling-relationships.html#cb682-1" tabindex="-1"></a>lin.model <span class="ot">&lt;-</span> <span class="fu">lm</span>( y_lin <span class="sc">~</span> x, <span class="at">data =</span> df)</span>
<span id="cb682-2"><a href="modeling-relationships.html#cb682-2" tabindex="-1"></a><span class="fu">summary</span>(lin.model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y_lin ~ x, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -49.674 -11.216   1.234  10.311  41.593 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.43743    3.64257   0.669    0.505    
## x            3.03273    0.06262  48.429   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 18.08 on 98 degrees of freedom
## Multiple R-squared:  0.9599, Adjusted R-squared:  0.9595 
## F-statistic:  2345 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>We will unpack most of the values throughout the rest of the chapter, but the first thing we want to notice is the <code>Estimate</code> column in the <code>Coefficients</code> table. Here you can read off the vertical intercept and the slope of the regression line. Thus, the line of best fit is</p>
<p><span class="math display">\[ \hat{y} = b_0 + b_1 x \approx 2.44 + 3.03x\]</span></p>
<p>Above we claimed that the line of best fit minimized the sum of squared error. Let’s see that this line of best fit has a smaller SSE than our eyeballed line from above.</p>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="modeling-relationships.html#cb684-1" tabindex="-1"></a><span class="co"># SSE of line of best fit</span></span>
<span id="cb684-2"><a href="modeling-relationships.html#cb684-2" tabindex="-1"></a><span class="fu">sum</span>(lin.model<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 32022.14</code></pre>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="modeling-relationships.html#cb686-1" tabindex="-1"></a><span class="co"># SSE of our eyeballed line</span></span>
<span id="cb686-2"><a href="modeling-relationships.html#cb686-2" tabindex="-1"></a><span class="fu">sum</span>(df<span class="sc">$</span>residual<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 36170.27</code></pre>
<p>As claimed, our eyeballed fit has a hire sum of squared error.</p>
<p>To close this quick introduction, let’s look at some real data. The data set <code>satgpa</code> from the <code>openintro</code> package provides information on 1000 randomly sampled students from an unnamed college. Let’s suppose we’re interested in the relationship between a student’s SAT verbal score and their math score, both given as percentiles. We postulate that there is an association between these variables. More specifically, we postulate that there is a positive association between these variables: on average, as a student’s SAT verbal score increases, so does their math score. The scatter plot below plots these variables against each other and includes a regression line.</p>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="modeling-relationships.html#cb688-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> satgpa,  <span class="fu">aes</span>(<span class="at">x =</span> sat_v, <span class="at">y =</span> sat_m) ) <span class="sc">+</span></span>
<span id="cb688-2"><a href="modeling-relationships.html#cb688-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">25</span>) <span class="sc">+</span> <span class="co">#this makes the dots transparent so that repeats are clearer in the image</span></span>
<span id="cb688-3"><a href="modeling-relationships.html#cb688-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="at">se =</span> F) <span class="sc">+</span> </span>
<span id="cb688-4"><a href="modeling-relationships.html#cb688-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;SAT Scores: Math vs Verbal&quot;</span>) <span class="sc">+</span></span>
<span id="cb688-5"><a href="modeling-relationships.html#cb688-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Verbal&#39;</span>) <span class="sc">+</span> </span>
<span id="cb688-6"><a href="modeling-relationships.html#cb688-6" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;Math&#39;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-408-1.png" width="672" /></p>
<p>As we hypothesized, there does appear to be a moderately strong positive linear association between these variables, though the fit of our line doesn’t seem as good as the fit of the line of best fit in our simulated example. In the next section, we will learn about two ways to measure the strength of a model’ fit.</p>
</div>
<div id="model-fit" class="section level3 hasAnchor" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Model fit<a href="modeling-relationships.html#model-fit" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We have two primary measurements for assessing the strength of a linear model: the correlation coefficient <span class="math inline">\(R\)</span> and the coefficient of determination <span class="math inline">\(R^2\)</span>. It will come as no surprise that the coefficient of determination really is just the square of the correlation coefficient, but it ends up having a nicer or more convenient interpretation and generalizes more readily to other types of models, so we tend to report the <span class="math inline">\(R^2\)</span> over <span class="math inline">\(R\)</span>.</p>
<p>The correlation coefficient <span class="math inline">\(R\)</span> is a number in the interval <span class="math inline">\([-1,1]\)</span>.</p>
<ul>
<li><p>If <span class="math inline">\(|R| = 1\)</span>, then your data exhibits a perfect linear association.</p></li>
<li><p>If <span class="math inline">\(R = 0\)</span>, then your data does not exhibit any <em>linear</em> association. Be careful, you could have some nonlinear association on your hands.</p></li>
<li><p>The sign of the correlation coefficient gives you the direction of the association: If <span class="math inline">\(R &gt;0\)</span>, then you have a positive association and if <span class="math inline">\(R &lt; 0\)</span>, you have a negative association.</p></li>
</ul>
<p><img src="_main_files/figure-html/unnamed-chunk-409-1.png" width="672" /></p>
<p>The plots above show a handful of relationships between the variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> and the title of each plot indicates how these values were created, so ‘pos’ is intended to have a positive linear relationship, ‘exp’ is sample from an exponential relationship, ‘circle’ gives points sample from a circle with radius 1, etc. The table below gives the correlation coefficients of each of these plots. You should check to make sure that these values correspond with your intuition.</p>
<table>
<thead>
<tr class="header">
<th align="left">grp</th>
<th align="right">cor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">circle</td>
<td align="right">-0.1812696</td>
</tr>
<tr class="even">
<td align="left">exp</td>
<td align="right">-0.8958734</td>
</tr>
<tr class="odd">
<td align="left">neg</td>
<td align="right">-0.9771810</td>
</tr>
<tr class="even">
<td align="left">none</td>
<td align="right">-0.1591399</td>
</tr>
<tr class="odd">
<td align="left">pos</td>
<td align="right">0.8679997</td>
</tr>
<tr class="even">
<td align="left">quad</td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
</div>
<div id="hypothesis-testing-5" class="section level3 hasAnchor" number="8.1.3">
<h3><span class="header-section-number">8.1.3</span> Hypothesis testing<a href="modeling-relationships.html#hypothesis-testing-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="prediction" class="section level3 hasAnchor" number="8.1.4">
<h3><span class="header-section-number">8.1.4</span> Prediction<a href="modeling-relationships.html#prediction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>interpolation vs extrapolation</p></li>
<li><p>confidence intervals</p></li>
<li><p>prediction intervals</p></li>
</ul>
</div>
</div>
<div id="multiple-linear-regression" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Multiple linear regression<a href="modeling-relationships.html#multiple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="modeling-relationships.html#cb689-1" tabindex="-1"></a><span class="fu">lm</span>(fy_gpa <span class="sc">~</span> sat_v <span class="sc">+</span> sat_m <span class="sc">+</span> hs_gpa, <span class="at">data =</span> satgpa) <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = fy_gpa ~ sat_v + sat_m + hs_gpa, data = satgpa)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.10154 -0.35893  0.02541  0.41321  1.61394 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.866927   0.149202  -5.810 8.38e-09 ***
## sat_v        0.016459   0.002648   6.215 7.55e-10 ***
## sat_m        0.012398   0.002601   4.766 2.16e-06 ***
## hs_gpa       0.580068   0.038463  15.081  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5942 on 996 degrees of freedom
## Multiple R-squared:  0.3586, Adjusted R-squared:  0.3567 
## F-statistic: 185.6 on 3 and 996 DF,  p-value: &lt; 2.2e-16</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="inferential-statistics-take-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/07-modeling.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
